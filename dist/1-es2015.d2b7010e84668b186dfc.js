(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"I/3d":function(t,e,n){"use strict";n.d(e,"a",function(){return vd});var r=n("fXoL"),i=n("D0XW"),o=n("HDdC"),s=n("Cfvw"),u=n("LRne"),a=n("JX91"),c=n("Zy1z"),h=n("lJxs"),f=n("Kqap"),l=n("/uUt"),p=n("pLZG"),d=n("pxpQ"),v=n("spgP"),y=n("ofXK"),g=n("Jgta"),b=n("zIRd"),m=n("q/0M"),w=n("qOnz"),I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function O(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},j=E||self;function A(){}function N(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var x="closure_uid_"+(1e9*Math.random()>>>0),k=0;function D(t,e,n){return t.call.apply(t.bind,arguments)}function C(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function P(t,e,n){return(P=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?D:C).apply(null,arguments)}function L(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function R(){return Date.now()}function V(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,x)&&t[x]||(t[x]=++k)}(this)},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var M=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var B,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:t>e?1:0}t:{var W=j.navigator;if(W){var X=W.userAgent;if(X){B=X;break t}}B=""}function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e={};for(var n in t)e[n]=t[n];return e}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<$.length;o++)n=$[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function tt(t){return tt[" "](t),t}tt[" "]=A;var et,nt,rt=K(B,"Opera"),it=K(B,"Trident")||K(B,"MSIE"),ot=K(B,"Edge"),st=ot||it,ut=K(B,"Gecko")&&!(K(B.toLowerCase(),"webkit")&&!K(B,"Edge"))&&!(K(B,"Trident")||K(B,"MSIE"))&&!K(B,"Edge"),at=K(B.toLowerCase(),"webkit")&&!K(B,"Edge");function ct(){var t=j.document;return t?t.documentMode:void 0}t:{var ht="",ft=(nt=B,ut?/rv:([^\);]+)(\)|;)/.exec(nt):ot?/Edge\/([\d\.]+)/.exec(nt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(nt):at?/WebKit\/(\S+)/.exec(nt):rt?/(?:Version)[ \/]?(\S+)/.exec(nt):void 0);if(ft&&(ht=ft?ft[1]:""),it){var lt=ct();if(null!=lt&&lt>parseFloat(ht)){et=String(lt);break t}}et=ht}var pt={};function dt(t){return function(t,e){var n=pt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=H(String(et)).split("."),r=H(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=J(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||J(0==s[2].length,0==u[2].length)||J(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var vt=j.document&&it&&(ct()||parseInt(et,10))||void 0,yt=!it||9<=Number(vt),gt=it&&!dt("9"),bt=function(){if(!j.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{j.addEventListener("test",A,e),j.removeEventListener("test",A,e)}catch(n){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{tt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},V(wt,mt);var It={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Ot="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function jt(t){this.src=t,this.a={},this.b=0}function At(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=M(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Tt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Nt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}jt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Nt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),xt={};function kt(t,e,n,r,i){if(r&&r.once)return Ct(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[Ot]?t.va(e,n,S(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=S(i)?!!i.capture:!!i;if(s&&!yt)return null;var u=Mt(t);if(u||(t[St]=u=new jt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ut,e=yt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[Ot]?t.wa(e,n,S(r)?!!r.capture:!!r,i):Dt(t,e,n,!0,r,i)}function Pt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);else r=S(r)?!!r.capture:!!r,n=Ft(n),t&&t[Ot]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Nt(o=t.a[e],n,r,i))&&(Tt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Mt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Nt(e,n,r,i)),(n=-1<t?e[t]:null)&&Lt(n))}function Lt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Ot])At(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(At(n,t),0==n.b&&(n.src=null,e[St]=null)):Tt(t)}}}function Rt(t){return t in xt?xt[t]:xt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(!yt){if(!e)t:{e=["window","event"];for(var n=j,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new wt(e,this))}return Vt(t,new wt(e,this))}function Mt(t){return(t=t[St])instanceof jt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(t){return"function"==typeof t?t:(t[qt]||(t[qt]=function(e){return t.handleEvent(e)}),t[qt])}function zt(){U.call(this),this.c=new jt(this),this.J=this,this.C=null}function Gt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new mt(e,t);else if(e instanceof mt)e.target=e.target||t;else{var i=e;Z(e=new mt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Bt(s,r,!0,e)&&i}if(i=Bt(s=e.a=t,r,!0,e)&&i,i=Bt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Bt(s=e.a=n[o],r,!1,e)&&i}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&At(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}V(zt,U),zt.prototype[Ot]=!0,(_=zt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},_.G=function(){if(zt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},_.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=j.JSON.stringify;function Kt(){this.b=this.a=null}var Jt,Wt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new Yt},function(t){t.reset()});function Xt(){var t=te,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Yt(){this.next=this.b=this.a=null}function Qt(t){j.setTimeout(function(){throw t},0)}function $t(t,e){Jt||function(){var t=j.Promise.resolve(void 0);Jt=function(){t.then(ee)}}(),Zt||(Jt(),Zt=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Yt.prototype.reset=function(){this.next=this.b=this.a=null};var Zt=!1,te=new Kt;function ee(){for(var t;t=Xt();){try{t.a.call(t.b)}catch(n){Qt(n)}var e=Wt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Zt=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||j,this.f=P(this.Za,this),this.g=R()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==typeof t)n&&(t=P(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=P(t.handleEvent,t)}return 2147483647<Number(e)?-1:j.setTimeout(t,e||0)}function oe(t){t.a=ie(function(){t.a=null,t.c&&(t.c=!1,oe(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}V(ne,zt),(_=ne.prototype).aa=!1,_.M=null,_.Za=function(){if(this.aa){var t=R()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Gt(this,"tick"),this.aa&&(re(this),this.start()))}},_.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=R())},_.G=function(){ne.X.G.call(this),re(this),delete this.a};var se=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}I(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:oe(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(j.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(U);function ue(t){U.call(this),this.b=t,this.a={}}V(ue,U);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ve(){return de=de||new zt}function ye(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ve();Gt(e,new ye(e,t))}function be(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function me(t){var e=ve();Gt(e,new be(e,t))}function we(t){mt.call(this,pe.Ga,t)}function Ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return j.setTimeout(function(){t()},e)}pe.Fa="serverreachability",V(ye,mt),pe.STAT_EVENT="statevent",V(be,mt),pe.Ga="timingevent",V(we,mt);var Oe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},_e={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ee(){}function Te(){}Ee.prototype.a=null;var je,Ae={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=De,this.R=new ne(t=st?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}V(Ne,mt),V(Se,mt),V(xe,Ee),je=new xe;var De=45e3,Ce={},Pe={};function Le(t,e,n){t.H=1,t.i=rn(Qe(e)),t.j=n,t.I=!0,Re(t,null)}function Re(t,e){t.u=R(),Me(t),t.l=Qe(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),gn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(P(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?Q(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ve(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ue(t,n);if(i==Pe){4==e&&(t.h=4,me(14),r=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ce){t.h=4,me(15),le(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}le(t.c,t.f,i,null),Be(t,i)}4==e&&0==n.length&&(t.h=1,me(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0,me(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),ze(t))}function Ue(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Pe:(n=Number(e.substring(n,r)),isNaN(n)?Ce:(r+=1)+n>e.length?Pe:(e=e.substr(r,n),t.D=r+n,e))}function Me(t){t.T=R()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(P(t.Va,t),e)}function Fe(t){t.o&&(j.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||sr(t.g,t)}function Ge(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||En(n.b,t)))if(n.I=t.N,!t.C&&En(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Ql){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;or(n),Wn(n)}nr(n),me(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ie(P(n.Sa,n),6e3));if(1>=_n(n.b)&&n.ea){try{n.ea()}catch(Ql){}n.ea=void 0}}else ar(n,11)}else if((t.C||n.a==t)&&or(n),!G(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(K(h,"spdy")||K(h,"quic")||K(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Tn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,nn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=R()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=hr(a,a.C?a.ga:null,a.fa),p.C){jn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Fe(d),Me(d)),a.a=p}else er(a);0<n.g.length&&Qn(n)}else"stop"!=i[0]&&"close"!=i[0]||ar(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ar(n,7):Jn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);ge(4)}catch(Ql){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(N(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(N(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(N(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)We(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=ke.prototype).setTimeout=function(t){this.P=t},_.Xa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},_.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||0>=r?3:2),Fe(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,me(12),Ge(this),ze(this);break t}le(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,a)}this.I?(Ve(this,e,o),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,o,null),Be(this,o)),4==e&&Ge(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Ge(this),ze(this)}}}catch(c){}},_.Wa=function(){if(this.a){var t=Gn(this.a),e=this.a.$();this.D<e.length&&(Fe(this),Ve(this,t,e),this.b&&4!=t&&Me(this))}},_.cancel=function(){this.A=!0,Ge(this)},_.Va=function(){this.o=null;var t=R();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(ge(3),me(17)),Ge(this),this.h=2,ze(this)):qe(this,this.T-t)},(_=Ke.prototype).K=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.L=function(){return Je(this),this.a.concat()},_.get=function(t,e){return We(this.b,t)?this.b[t]:e},_.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye){this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Ze(this,t.c),tn(this,t.h),this.g=t.g,e=t.b;var n=new pn;n.c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),en(this,n),this.i=t.i}else t&&(n=String(t).match(Xe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=on(n[2]||""),Ze(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function Qe(t){return new Ye(t)}function $e(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){e instanceof pn?(t.b=e,function(t,e){e&&!t.f&&(dn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),gn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=sn(e,fn)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^R()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,an,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(sn(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?hn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,ln)),t.join("")};var an=/[#\/\?@]/g,cn=/[#\?:]/g,hn=/[#\?]/g,fn=/[#\?@]/g,ln=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(t){t.a||(t.a=new Ke,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function vn(t,e){dn(t),e=bn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t)))}function yn(t,e){return dn(t),e=bn(t,e),We(t.a.b,e)}function gn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),z(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(_=pn.prototype).add=function(t,e){dn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(t,e){dn(this),this.a.forEach(function(n,r){q(n,function(n){t.call(e,n,r,this)},this)},this)},_.L=function(){dn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.K=function(t){dn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=F(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},_.set=function(t,e){return dn(this),this.c=null,yn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var mn=function(){return function(t,e){this.b=t,this.a=e}}();function wn(t){this.g=t||In,t=j.PerformanceNavigationTiming?0<(t=j.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(j.ia&&j.ia.ya&&j.ia.ya()&&j.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var In=10;function On(t){return!!t.b||!!t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function jn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=O(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return z(t.c)}function Nn(){}function Sn(){this.a=new Nn}function xn(t,e,n){var r=n||"";try{He(t,function(t,n){var i=t;S(t)&&(i=Ht(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Up){throw e.push(r+"type="+encodeURIComponent("_badmap")),Up}}function kn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}wn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=O(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return j.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return j.JSON.parse(t,void 0)};var Dn=j.JSON.parse;function Cn(t){zt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}V(Cn,zt);var Pn="",Ln=/^https?$/i,Rn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),Fn(t)}function Mn(t){t.u||(t.u=!0,Gt(t,"complete"),Gt(t,"error"))}function qn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=Gn(t)||2!=t.W()))if(t.l&&4==Gn(t))ie(t.za,0,t);else if(Gt(t,"readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Xe)[1]||null;if(!o&&j.self&&j.self.location){var s=j.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ln.test(o?o.toLowerCase():"")}e=i}if(e)Gt(t,"complete"),Gt(t,"success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){zn(t);var n=t.a,r=t.s[0]?A:null;t.a=null,t.s=null,e||Gt(t,"ready");try{n.onreadystatechange=r}catch(Up){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(j.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Y(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Hn("baseRetryDelayMs",5e3,t),this.Ra=Hn("retryDelaySeedMs",1e4,t),this.Ma=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Jn(t){if(Xn(t),3==t.v){var e=t.R++,n=Qe(t.B);nn(n,"SID",t.J),nn(n,"RID",e),nn(n,"TYPE","terminate"),Zn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=rn(Qe(n)),n=!1,j.navigator&&j.navigator.sendBeacon&&(n=j.navigator.sendBeacon(e.i.toString(),"")),!n&&j.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=R(),Me(e)}cr(t)}function Wn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Xn(t){Wn(t),t.j&&(j.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&j.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Qn(t)}function Qn(t){On(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function $n(t,e){var n;n=e?e.f:t.R++;var r=Qe(t.B);nn(r,"SID",t.J),nn(r,"RID",n),nn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Zn(t,e){t.f&&He({},function(t,n){nn(e,n,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?P(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{xn(h,s,"req"+c+"_")}catch(Jr){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.T=1,$t(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Ie(P(t.Aa,t),ur(t,t.o)),t.o++,0))}function rr(t){null!=t.s&&(j.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);nn(e,"RID","rpc"),nn(e,"SID",t.J),nn(e,"CI",t.H?"0":"1"),nn(e,"AID",t.P),Zn(t,e),nn(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=rn(Qe(e)),n.j=null,n.I=!0,Re(n,t)}function or(t){null!=t.m&&(j.clearTimeout(t.m),t.m=null)}function sr(t,e){var n=null;if(t.a==e){or(t),rr(t),t.a=null;var r=2}else{if(!En(t.b,e))return;n=e.s,jn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=R()-e.u;var i=t.u;Gt(r=ve(),new we(r,n,e,i)),Qn(t)}else er(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(_n(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Ie(P(t.Ba,t,e),ur(t,t.u)),t.u++,0)))}(t,e)||2==r&&nr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ar(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=P(t.Ya,t);n||(n=new Ye("//www.google.com/images/cleardot.gif"),j.location&&"http"==j.location.protocol||$e(n,"https"),rn(n)),function(t,e){var n=new fe;if(j.Image){var r=new Image;r.onload=L(kn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=L(kn,n,r,"TestLoadImage: error",!1,e),r.onabort=L(kn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=L(kn,n,r,"TestLoadImage: timeout",!1,e),j.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else me(2);t.v=0,t.f&&t.f.ra(e),cr(t),Xn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function hr(t,e,n){var r=function(t){return t instanceof Ye?Qe(t):new Ye(t,void 0)}(n);if(""!=r.c)e&&Ze(r,e+"."+r.c),tn(r,r.h);else{var i=j.location;r=function(t,e,n,r){var i=new Ye(null,void 0);return t&&$e(i,t),e&&Ze(i,e),n&&tn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Y(t.V,function(t,e){nn(r,e,t)}),n=t.na,(e=t.A)&&n&&nn(r,e,n),nn(r,"VER",t.ha),Zn(t,r),r}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Na)).F=t.C,e}function lr(){}function pr(){if(it&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function dr(t,e){zt.call(this),this.a=new Kn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function vr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function yr(){Se.call(this),this.status=1}function gr(t){this.a=t}(_=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:je),this.a.onreadystatechange=P(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Un(this,o)}t=n||"";var i=new Ke(this.headers);r&&He(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=j.FormData&&t instanceof j.FormData,!(0<=M(Rn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=function(t){return it&&dt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=P(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Un(this,o)}},_.xa=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Gt(this,"timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Gt(this,"complete"),Gt(this,"abort"),Fn(this))},_.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Cn.X.G.call(this)},_.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ua())},_.Ua=function(){qn(this)},_.W=function(){try{return 2<Gn(this)?this.a.status:-1}catch(nt){return-1}},_.$=function(){try{return this.a?this.a.responseText:""}catch(nt){return""}},_.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},_.ua=function(){return this.h},_.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Kn.prototype).ha=8,_.v=1,_.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Z(r=Q(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),nn(i=Qe(this.B),"RID",t),nn(i,"CVER",22),this.A&&nn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ia&&nn(i,"TYPE","init"),this.da?(nn(i,"$req",e),nn(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||On(this.b)||$n(this))},_.Aa=function(){if(this.j=null,ir(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ie(P(this.Ta,this),t)}},_.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,me(10),Wn(this),ir(this))},_.Sa=function(){null!=this.m&&(this.m=null,Wn(this),nr(this),me(19))},_.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(_=lr.prototype).ta=function(){},_.sa=function(){},_.ra=function(){},_.qa=function(){},_.Ja=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},V(dr,zt),dr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;me(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=hr(t,null,t.fa),Qn(t)},dr.prototype.close=function(){Jn(this.a)},dr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Yn(this.a,e)}else this.l?((e={}).__data__=Ht(t),Yn(this.a,e)):Yn(this.a,t)},dr.prototype.G=function(){this.a.f=null,delete this.f,Jn(this.a),delete this.a,dr.X.G.call(this)},V(vr,Ne),V(yr,Se),V(gr,lr),gr.prototype.ta=function(){Gt(this.a,"a")},gr.prototype.sa=function(t){Gt(this.a,new vr(t))},gr.prototype.ra=function(t){Gt(this.a,new yr(t))},gr.prototype.qa=function(){Gt(this.a,"b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.h,dr.prototype.open=dr.prototype.g,dr.prototype.close=dr.prototype.close,Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,_e.COMPLETE="complete",Te.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.W,Cn.prototype.getResponseJson=Cn.prototype.Pa,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var br=Oe,mr=_e,wr=pe,Ir=Te,Or=Cn,_r=n("30Go"),Er=new m.b("@firebase/firestore");function Tr(){return Er.logLevel}function jr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=m.a.DEBUG){var r=e.map(Sr);Er.debug.apply(Er,Object(_r.g)(["Firestore (8.2.2): "+t],r))}}function Ar(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=m.a.ERROR){var r=e.map(Sr);Er.error.apply(Er,Object(_r.g)(["Firestore (8.2.2): "+t],r))}}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=m.a.WARN){var r=e.map(Sr);Er.warn.apply(Er,Object(_r.g)(["Firestore (8.2.2): "+t],r))}}function Sr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Up){return t}}function xr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw Ar(e),new Error(e)}function kr(t,e){t||xr()}function Dr(t,e){return t}function Cr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Pr=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Cr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Lr(t,e){return t<e?-1:t>e?1:0}function Rr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Vr(t){return t+"\0"}var Ur=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return Lr(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Ur.h=new Ur("");var Mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(_r.c)(e,t),e}(Error),Fr=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Ur.fromBase64String(e))}catch(e){throw new qr(Mr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ur.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),zr=function(t){this._=t};function Gr(){if("undefined"==typeof Uint8Array)throw new qr(Mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Br(){if("undefined"==typeof atob)throw new qr(Mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.fromBase64String=function(t){return Br(),new e(Fr.fromBase64String(t))},e.fromUint8Array=function(t){return Gr(),new e(Fr.fromUint8Array(t))},e.prototype.toBase64=function(){return Br(),this._.toBase64()},e.prototype.toUint8Array=function(){return Gr(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(zr),Kr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Jr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Wr=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Wr.UNAUTHENTICATED=new Wr(null),Wr.P=new Wr("google-credentials-uid"),Wr.g=new Wr("first-party-uid");var Xr=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Yr=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Wr.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Qr=function(){function t(t){var e=this;this.C=null,this.currentUser=Wr.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.O!==e?(jr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(kr("string"==typeof n.accessToken),new Xr(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new Wr(t)},t}(),$r=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Wr.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Zr=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new $r(this.k,this.M))},t.prototype.S=function(t){t(Wr.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),ti=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();ti.U=-1;var ei=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new qr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new qr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?Lr(this.nanoseconds,t.nanoseconds):Lr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ni=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new ei(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),ri=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new qr(Mr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(ri),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return oi.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new qr(Mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new qr(Mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new qr(Mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new qr(Mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(ri),ui=function(){function t(t){this.path=t}return t.ft=function(e){return new t(ii.ct(e))},t.dt=function(e){return new t(ii.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ii.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return ii.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new ii(e.slice()))},t}();function ai(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ci(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var fi=function(){function t(t){this.fields=t,t.sort(si.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Rr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),li=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(t){if(kr(!!t),"string"==typeof t){var e=0,n=li.exec(t);if(kr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:di(t.seconds),nanos:di(t.nanos)}}function di(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vi(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function yi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function gi(t){var e=t.mapValue.fields.__previous_value__;return yi(e)?gi(e):e}function bi(t){var e=pi(t.mapValue.fields.__local_write_time__.timestampValue);return new ei(e.seconds,e.nanos)}function mi(t){return null==t}function wi(t){return 0===t&&1/t==-1/0}function Ii(t){return"number"==typeof t&&Number.isInteger(t)&&!wi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Oi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yi(t)?4:10:xr()}function _i(t,e){var n=Oi(t);if(n!==Oi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bi(t).isEqual(bi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=pi(t.timestampValue),r=pi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return vi(t.bytesValue).isEqual(vi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return di(t.geoPointValue.latitude)===di(e.geoPointValue.latitude)&&di(t.geoPointValue.longitude)===di(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return di(t.integerValue)===di(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=di(t.doubleValue),r=di(e.doubleValue);return n===r?wi(n)===wi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Rr(t.arrayValue.values||[],e.arrayValue.values||[],_i);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ai(n)!==ai(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!_i(n[i],r[i])))return!1;return!0}(t,e);default:return xr()}}function Ei(t,e){return void 0!==(t.values||[]).find(function(t){return _i(t,e)})}function Ti(t,e){var n=Oi(t),r=Oi(e);if(n!==r)return Lr(n,r);switch(n){case 0:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=di(t.integerValue||t.doubleValue),r=di(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ji(t.timestampValue,e.timestampValue);case 4:return ji(bi(t),bi(e));case 5:return Lr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=vi(t),r=vi(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Lr(n[i],r[i]);if(0!==o)return o}return Lr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Lr(di(t.latitude),di(e.latitude));return 0!==n?n:Lr(di(t.longitude),di(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ti(n[i],r[i]);if(o)return o}return Lr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Lr(r[s],o[s]);if(0!==u)return u;var a=Ti(n[r[s]],i[o[s]]);if(0!==a)return a}return Lr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function ji(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Lr(t,e);var n=pi(t),r=pi(e),i=Lr(n.seconds,r.seconds);return 0!==i?i:Lr(n.nanos,r.nanos)}function Ai(t){return Ni(t)}function Ni(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=pi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?vi(t.bytesValue).toBase64():"referenceValue"in t?ui.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ni(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ni(t.fields[o])}return e+"}"}(t.mapValue):xr();var e}function Si(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function xi(t){return!!t&&"integerValue"in t}function ki(t){return!!t&&"arrayValue"in t}function Di(t){return!!t&&"nullValue"in t}function Ci(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pi(t){return!!t&&"mapValue"in t}var Li=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Pi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return _i(this.proto,t.proto)},t}(),Ri=function(){function t(t){void 0===t&&(t=Li.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Oi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(si.at(),this.Rt);return null!=t?new Li(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Pi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Vi(t){var e=[];return ci(t.fields||{},function(t,n){var r=new si([t]);if(Pi(n)){var i=Vi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new fi(e)}var Ui=function(t,e){this.key=t,this.version=e},Mi=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(_r.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ui),qi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(_r.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ui),Fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ui),zi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new zi(t,e,n,r,i,o,s)}function Bi(t){var e=Dr(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+Ai(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),mi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ro(e.startAt)),e.endAt&&(n+="|ub:",n+=ro(e.endAt)),e.St=n}return e.St}function Hi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!oo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!_i(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uo(t.startAt,e.startAt)&&uo(t.endAt,e.endAt)}function Ki(t){return ui.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ji=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(_r.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Wi(t,n,r):"array-contains"===n?new $i(t,r):"in"===n?new Zi(t,r):"not-in"===n?new to(t,r):"array-contains-any"===n?new eo(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Xi(t,n):new Yi(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(Ti(e,this.value)):null!==e&&Oi(this.value)===Oi(e)&&this.Ct(Ti(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return xr()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Wi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ui.dt(r.referenceValue),i}return Object(_r.c)(e,t),e.prototype.matches=function(t){var e=ui.J(t.key,this.key);return this.Ct(e)},e}(Ji),Xi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Qi(0,n),r}return Object(_r.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ji),Yi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Qi(0,n),r}return Object(_r.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ji);function Qi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ui.dt(t.referenceValue)})}var $i=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(_r.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return ki(e)&&Ei(e.arrayValue,this.value)},e}(Ji),Zi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(_r.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ei(this.value.arrayValue,e)},e}(Ji),to=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(_r.c)(e,t),e.prototype.matches=function(t){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ei(this.value.arrayValue,e)},e}(Ji),eo=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(_r.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ki(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ei(e.value.arrayValue,t)})},e}(Ji),no=function(t,e){this.position=t,this.before=e};function ro(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Ai(t)}).join(",")}var io=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function oo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function so(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?ui.J(ui.dt(s.referenceValue),n.key):Ti(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function uo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!_i(t.position[n],e.position[n]))return!1;return!0}var ao=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null};function co(t,e,n,r,i,o,s,u){return new ao(t,e,n,r,i,o,s,u)}function ho(t){return new ao(t)}function fo(t){return!mi(t.limit)&&"F"===t.limitType}function lo(t){return!mi(t.limit)&&"L"===t.limitType}function po(t){return t.Nt.length>0?t.Nt[0].field:null}function vo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function yo(t){return null!==t.collectionGroup}function go(t){var e=Dr(t);if(null===e.Ot){e.Ot=[];var n=vo(e),r=po(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new io(n)),e.Ot.push(new io(si.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ot.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new io(si.lt(),a))}}}return e.Ot}function bo(t){var e=Dr(t);if(!e.Ft)if("F"===e.limitType)e.Ft=Gi(e.path,e.collectionGroup,go(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=go(e);r<i.length;r++){var o=i[r];n.push(new io(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new no(e.endAt.position,!e.endAt.before):null,u=e.startAt?new no(e.startAt.position,!e.startAt.before):null;e.Ft=Gi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function mo(t,e,n){return new ao(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wo(t,e){return Hi(bo(t),bo(e))&&t.limitType===e.limitType}function Io(t){return Bi(bo(t))+"|lt:"+t.limitType}function Oo(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+Ai(e.value);var e}).join(", ")+"]"),mi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ro(t.startAt)),t.endAt&&(e+=", endAt: "+ro(t.endAt)),"Target("+e+")"}(bo(t))+"; limitType="+t.limitType+")"}function _o(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):ui.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!so(t.startAt,go(t),e)||t.endAt&&so(t.endAt,go(t),e))}(t,e)}function Eo(t){return function(e,n){for(var r=!1,i=0,o=go(t);i<o.length;i++){var s=o[i],u=To(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function To(t,e,n){var r=t.field.ht()?ui.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ti(r,i):xr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return xr()}}var jo=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=Ur.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function Ao(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wi(e)?"-0":e}}function No(t){return{integerValue:""+t}}function So(t,e){return Ii(e)?No(e):Ao(t,e)}var xo=function(){this.Ut=void 0};function ko(t,e,n){return t instanceof Po?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Lo?Ro(t,e):t instanceof Vo?Uo(t,e):function(t,e){var n=Co(t,e),r=qo(n)+qo(t.Qt);return xi(n)&&xi(t.Qt)?No(r):Ao(t.Kt,r)}(t,e)}function Do(t,e,n){return t instanceof Lo?Ro(t,e):t instanceof Vo?Uo(t,e):n}function Co(t,e){return t instanceof Mo?xi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e}(xo),Lo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(_r.c)(e,t),e}(xo);function Ro(t,e){for(var n=Fo(e),r=function(t){n.some(function(e){return _i(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(_r.c)(e,t),e}(xo);function Uo(t,e){for(var n=Fo(e),r=function(t){n=n.filter(function(e){return!_i(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Mo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(_r.c)(e,t),e}(xo);function qo(t){return di(t.integerValue||t.doubleValue)}function Fo(t){return ki(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var zo=function(t,e){this.field=t,this.transform=e},Go=function(t,e){this.version=t,this.transformResults=e},Bo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ho(t,e){return void 0!==t.updateTime?e instanceof Mi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Mi}var Ko=function(){};function Jo(t,e,n){return t instanceof $o?function(t,e,n){var r=t.value;if(n.transformResults){var i=es(t.fieldTransforms,e,n.transformResults);r=rs(t.fieldTransforms,r,i)}return new Mi(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Zo?function(t,e,n){if(!Ho(t.Gt,e))return new Fi(t.key,n.version);var r=ts(t,e,n.transformResults?es(t.fieldTransforms,e,n.transformResults):[]);return new Mi(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new qi(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Wo(t,e,n,r){return t instanceof $o?function(t,e,n,r){if(!Ho(t.Gt,e))return e;var i=t.value,o=ns(t.fieldTransforms,n,e);i=rs(t.fieldTransforms,i,o);var s=Qo(e);return new Mi(t.key,s,i,{bt:!0})}(t,e,r):t instanceof Zo?function(t,e,n,r){if(!Ho(t.Gt,e))return e;var i=Qo(e),o=ts(t,e,ns(t.fieldTransforms,n,e));return new Mi(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Ho(t.Gt,e)?new qi(t.key,ni.min()):e}(t,e)}function Xo(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Mi?e.field(o.field):void 0,u=Co(o.transform,s||null);null!=u&&(n=null==n?(new Ri).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function Yo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Rr(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Lo&&e instanceof Lo||t instanceof Vo&&e instanceof Vo?Rr(t.elements,e.elements,_i):t instanceof Mo&&e instanceof Mo?_i(t.Qt,e.Qt):t instanceof Po&&e instanceof Po}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Qo(t){return t instanceof Mi?t.version:ni.min()}var $o=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(_r.c)(e,t),e}(Ko),Zo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(_r.c)(e,t),e}(Ko);function ts(t,e,n){var r;return r=function(t,e){var n=new Ri(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof Mi?e.data():Li.empty()),rs(t.fieldTransforms,r,n)}function es(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Mi&&(u=e.field(o.field)),r.push(Do(s,u,n[i]))}return r}function ns(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Mi&&(c=n.field(u.field)),i.push(ko(a,c,e))}return i}function rs(t,e,n){for(var r=new Ri(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var is,os,ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(_r.c)(e,t),e}(Ko),us=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(_r.c)(e,t),e}(Ko),as=function(t){this.count=t};function cs(t){switch(t){case Mr.OK:return xr();case Mr.CANCELLED:case Mr.UNKNOWN:case Mr.DEADLINE_EXCEEDED:case Mr.RESOURCE_EXHAUSTED:case Mr.INTERNAL:case Mr.UNAVAILABLE:case Mr.UNAUTHENTICATED:return!1;case Mr.INVALID_ARGUMENT:case Mr.NOT_FOUND:case Mr.ALREADY_EXISTS:case Mr.PERMISSION_DENIED:case Mr.FAILED_PRECONDITION:case Mr.ABORTED:case Mr.OUT_OF_RANGE:case Mr.UNIMPLEMENTED:case Mr.DATA_LOSS:return!0;default:return xr()}}function hs(t){if(void 0===t)return Ar("GRPC error has no .code"),Mr.UNKNOWN;switch(t){case is.OK:return Mr.OK;case is.CANCELLED:return Mr.CANCELLED;case is.UNKNOWN:return Mr.UNKNOWN;case is.DEADLINE_EXCEEDED:return Mr.DEADLINE_EXCEEDED;case is.RESOURCE_EXHAUSTED:return Mr.RESOURCE_EXHAUSTED;case is.INTERNAL:return Mr.INTERNAL;case is.UNAVAILABLE:return Mr.UNAVAILABLE;case is.UNAUTHENTICATED:return Mr.UNAUTHENTICATED;case is.INVALID_ARGUMENT:return Mr.INVALID_ARGUMENT;case is.NOT_FOUND:return Mr.NOT_FOUND;case is.ALREADY_EXISTS:return Mr.ALREADY_EXISTS;case is.PERMISSION_DENIED:return Mr.PERMISSION_DENIED;case is.FAILED_PRECONDITION:return Mr.FAILED_PRECONDITION;case is.ABORTED:return Mr.ABORTED;case is.OUT_OF_RANGE:return Mr.OUT_OF_RANGE;case is.UNIMPLEMENTED:return Mr.UNIMPLEMENTED;case is.DATA_LOSS:return Mr.DATA_LOSS;default:return xr()}}(os=is||(is={}))[os.OK=0]="OK",os[os.CANCELLED=1]="CANCELLED",os[os.UNKNOWN=2]="UNKNOWN",os[os.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",os[os.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",os[os.NOT_FOUND=5]="NOT_FOUND",os[os.ALREADY_EXISTS=6]="ALREADY_EXISTS",os[os.PERMISSION_DENIED=7]="PERMISSION_DENIED",os[os.UNAUTHENTICATED=16]="UNAUTHENTICATED",os[os.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",os[os.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",os[os.ABORTED=10]="ABORTED",os[os.OUT_OF_RANGE=11]="OUT_OF_RANGE",os[os.UNIMPLEMENTED=12]="UNIMPLEMENTED",os[os.INTERNAL=13]="INTERNAL",os[os.UNAVAILABLE=14]="UNAVAILABLE",os[os.DATA_LOSS=15]="DATA_LOSS";var fs=function(){function t(t,e){this.J=t,this.root=e||ps.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,ps.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,ps.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new ls(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new ls(this.root,t,this.J,!1)},t.prototype.se=function(){return new ls(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new ls(this.root,t,this.J,!0)},t}(),ls=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),ps=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw xr();if(this.right._e())throw xr();var t=this.left.me();if(t!==this.right.me())throw xr();return t+(this._e()?0:1)},t}();ps.EMPTY=null,ps.RED=!0,ps.Jt=!1,ps.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new ps(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var ds=function(){function t(t){this.J=t,this.data=new fs(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new vs(this.data.ee())},t.prototype.ne=function(t){return new vs(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),vs=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),ys=new fs(ui.J);function gs(){return ys}function bs(){return gs()}var ms=new fs(ui.J);function ws(){return ms}var Is=new fs(ui.J);function Os(){return Is}var _s=new ds(ui.J);function Es(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=_s,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ts=new ds(Lr);function js(){return Ts}var As=function(){function t(t){this.J=t?function(e,n){return t(e,n)||ui.J(e.key,n.key)}:function(t,e){return ui.J(t.key,e.key)},this.Ve=ws(),this.pe=new fs(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),Ns=function(){function t(){this.ve=new fs(ui.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):xr():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),Ss=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Oe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,As.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&wo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),xs=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,ks.Be(e,n)),new t(ni.min(),r,js(),gs(),Es())},t}(),ks=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(Ur.h,n,Es(),Es(),Es())},t}(),Ds=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},Cs=function(t,e){this.targetId=t,this.Ge=e},Ps=function(t,e,n,r){void 0===n&&(n=Ur.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ls=function(){function t(){this.ze=0,this.He=Us(),this.Je=Ur.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=Es(),e=Es(),n=Es();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:xr()}}),new ks(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Us()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),Rs=function(){function t(t){this.hn=t,this.ln=new Map,this._n=gs(),this.fn=Vs(),this.dn=new ds(Lr)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Mi?this.En(r,t.We):t.We instanceof qi&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:xr()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Ki(i))if(0===n){var o=new ui(i.path);this.Tn(e,o,new qi(o,ni.min()))}else kr(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&Ki(o.target)){var s=new ui(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new qi(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=Es();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new xs(t,n,this.dn,this._n,r);return this._n=gs(),this.fn=Vs(),this.dn=new ds(Lr),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ls,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new ds(Lr),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||jr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new Ls),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function Vs(){return new fs(ui.J)}function Us(){return new fs(ui.J)}var Ms={asc:"ASCENDING",desc:"DESCENDING"},qs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fs=function(t,e){this.T=t,this.qt=e};function zs(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gs(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Bs(t,e){return zs(t,e.G())}function Hs(t){return kr(!!t),ni.j(function(t){var e=pi(t);return new ei(e.seconds,e.nanos)}(t))}function Ks(t,e){return function(t){return new ii(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Js(t){var e=ii.ct(t);return kr(gu(e)),e}function Ws(t,e){return Ks(t.T,e.path)}function Xs(t,e){var n=Js(e);if(n.get(1)!==t.T.projectId)throw new qr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new qr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new ui(Zs(n))}function Ys(t,e){return Ks(t.T,e)}function Qs(t){var e=Js(t);return 4===e.length?ii.at():Zs(e)}function $s(t){return new ii(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Zs(t){return kr(t.length>4&&"documents"===t.get(4)),t.X(5)}function tu(t,e,n){return{name:Ws(t,e),fields:n.proto.mapValue.fields}}function eu(t,e,n){var r=Xs(t,e.name),i=Hs(e.updateTime),o=new Li({mapValue:{fields:e.fields}});return new Mi(r,i,o,{hasCommittedMutations:!!n})}function nu(t,e){var n;if(e instanceof $o)n={update:tu(t,e.key,e.value)};else if(e instanceof ss)n={delete:Ws(t,e.key)};else if(e instanceof Zo)n={update:tu(t,e.key,e.data),updateMask:yu(e.zt)};else{if(!(e instanceof us))return xr();n={verify:Ws(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Po)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof Lo)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof Vo)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof Mo)return{fieldPath:e.field.ot(),increment:n.Qt};throw xr()}(0,t)})),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Bs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:xr()}(t,e.Gt)),n}function ru(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Bo.updateTime(Hs(t.updateTime)):void 0!==t.exists?Bo.exists(t.exists):Bo.jt()}(e.currentDocument):Bo.jt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(kr("REQUEST_TIME"===e.setToServerValue),n=new Po):"appendMissingElements"in e?n=new Lo(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Vo(e.removeAllFromArray.values||[]):"increment"in e?n=new Mo(t,e.increment):xr();var r=si._t(e.fieldPath);return new zo(r,n)}(t,e)}):[];if(e.update){var i=Xs(t,e.update.name),o=new Li({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new fi((t.fieldPaths||[]).map(function(t){return si._t(t)}))}(e.updateMask);return new Zo(i,o,s,n,r)}return new $o(i,o,n,r)}if(e.delete){var u=Xs(t,e.delete);return new ss(u,n)}if(e.verify){var a=Xs(t,e.verify);return new us(a,n)}return xr()}function iu(t,e){return{documents:[Ys(t,e.path)]}}function ou(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ys(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ys(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Ci(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NAN"}};if(Di(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ci(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NOT_NAN"}};if(Di(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lu(t.field),op:fu(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:lu(t.field),direction:hu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||mi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=au(e.startAt)),e.endAt&&(n.structuredQuery.endAt=au(e.endAt)),n}function su(t){var e=Qs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){kr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=uu(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new io(pu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return mi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=cu(n.startAt));var h=null;return n.endAt&&(h=cu(n.endAt)),co(e,i,u,s,a,"F",c,h)}function uu(t){return t?void 0!==t.unaryFilter?[vu(t)]:void 0!==t.fieldFilter?[du(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return uu(t)}).reduce(function(t,e){return t.concat(e)}):xr():[]}function au(t){return{before:t.before,values:t.position}}function cu(t){return new no(t.values||[],!!t.before)}function hu(t){return Ms[t]}function fu(t){return qs[t]}function lu(t){return{fieldPath:t.ot()}}function pu(t){return si._t(t.fieldPath)}function du(t){return Ji.create(pu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xr()}}(t.fieldFilter.op),t.fieldFilter.value)}function vu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=pu(t.unaryFilter.field);return Ji.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=pu(t.unaryFilter.field);return Ji.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=pu(t.unaryFilter.field);return Ji.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=pu(t.unaryFilter.field);return Ji.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xr()}}function yu(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function gu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var bu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},mu=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&xr(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),wu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new bu,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new _u(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=Nu(e.target.error);n.qn.reject(new _u(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new _u(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(jr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Tu(e)},t}(),Iu=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(w.g)())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return jr("SimpleDb","Removing database:",t),ju(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(w.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n=this;return Object(_r.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(jr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new _u(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new qr(Mr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new _u(t,n))},i.onupgradeneeded=function(t){jr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){jr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(_r.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(_r.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=wu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),mu.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return jr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ou=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return ju(this.ts.delete())},t}(),_u=function(t){function e(e,n){var r=this;return(r=t.call(this,Mr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(_r.c)(e,t),e}(qr);function Eu(t){return"IndexedDbTransactionError"===t.name}var Tu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(jr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(jr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ju(n)},t.prototype.add=function(t){return jr("SimpleDb","ADD",this.store.name,t,t),ju(this.store.add(t))},t.prototype.get=function(t){var e=this;return ju(this.store.get(t)).next(function(n){return void 0===n&&(n=null),jr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return jr("SimpleDb","DELETE",this.store.name,t),ju(this.store.delete(t))},t.prototype.count=function(){return jr("SimpleDb","COUNT",this.store.name),ju(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){jr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new mu(function(n,r){e.onerror=function(t){var e=Nu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new mu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ou(i),s=e(i.primaryKey,i.value,o);if(s instanceof mu){var u=s.catch(function(t){return o.done(),mu.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return mu.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ju(t){return new mu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Nu(t.target.error);n(e)}})}var Au=!1;function Nu(t){var e=Iu.Kn(Object(w.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Au||(Au=!0,setTimeout(function(){throw r},0)),r}}return t}var Su=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new bu,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new qr(Mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function xu(t,e){if(Ar("AsyncQueue",e+": "+t),Eu(t))return new qr(Mr.UNAVAILABLE,e+": "+t);throw t}var ku="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Du=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function Cu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Lu(e)),e=Pu(t.get(n),e);return Lu(e)}function Pu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Lu(t){return t+"\x01\x01"}function Ru(t){var e=t.length;if(kr(e>=2),2===e)return kr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ii.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&xr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:xr()}o=s+2}return new ii(r)}var Vu=function(t,e){this.seconds=t,this.nanoseconds=e},Uu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Uu.store="owner",Uu.key="owner";var Mu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Mu.store="mutationQueues",Mu.keyPath="userId";var qu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};qu.store="mutations",qu.keyPath="batchId",qu.userMutationsIndex="userMutationsIndex",qu.userMutationsKeyPath=["userId","batchId"];var Fu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Cu(e)]},t.key=function(t,e,n){return[t,Cu(e),n]},t}();Fu.store="documentMutations",Fu.PLACEHOLDER=new Fu;var zu=function(t,e){this.path=t,this.readTime=e},Gu=function(t,e){this.path=t,this.version=e},Bu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Bu.store="remoteDocuments",Bu.readTimeIndex="readTimeIndex",Bu.readTimeIndexPath="readTime",Bu.collectionReadTimeIndex="collectionReadTimeIndex",Bu.collectionReadTimeIndexPath=["parentPath","readTime"];var Hu=function(t){this.byteSize=t};Hu.store="remoteDocumentGlobal",Hu.key="remoteDocumentGlobalKey";var Ku=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ku.store="targets",Ku.keyPath="targetId",Ku.queryTargetsIndexName="queryTargetsIndex",Ku.queryTargetsKeyPath=["canonicalId","targetId"];var Ju=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ju.store="targetDocuments",Ju.keyPath=["targetId","path"],Ju.documentTargetsIndex="documentTargetsIndex",Ju.documentTargetsKeyPath=["path","targetId"];var Wu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Wu.key="targetGlobalKey",Wu.store="targetGlobal";var Xu=function(t,e){this.collectionId=t,this.parent=e};Xu.store="collectionParents",Xu.keyPath=["collectionId","parent"];var Yu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Yu.store="clientMetadata",Yu.keyPath="clientId";var Qu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Qu.store="bundles",Qu.keyPath="bundleId";var $u=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};$u.store="namedQueries",$u.keyPath="name";var Zu=Object(_r.g)(Object(_r.g)(Object(_r.g)(Object(_r.g)([Mu.store,qu.store,Fu.store,Bu.store,Ku.store,Uu.store,Wu.store,Ju.store],[Yu.store]),[Hu.store]),[Xu.store]),[Qu.store,$u.store]),ta=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object(_r.c)(e,t),e}(Du);function ea(t,e){var n=Dr(t);return Iu.Hn(n.bs,e)}var na=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Jo(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Wo(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Wo(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Es())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Rr(this.mutations,t.mutations,function(t,e){return Yo(t,e)})&&Rr(this.baseMutations,t.baseMutations,function(t,e){return Yo(t,e)})},t}(),ra=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){kr(e.mutations.length===r.length);for(var i=Os(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ia=function(t){this.ks=t};function oa(t,e){if(e.document)return eu(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ui.Tt(e.noDocument.path),r=ha(e.noDocument.readTime);return new qi(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=ui.Tt(e.unknownDocument.path);return r=ha(e.unknownDocument.version),new Fi(i,r)}return xr()}function sa(t,e,n){var r=ua(n),i=e.key.path.Z().rt();if(e instanceof Mi){var o=function(t,e){return{name:Ws(t,e.key),fields:e.vt().mapValue.fields,updateTime:zs(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new Bu(null,null,o,s,r,i)}if(e instanceof qi){var u=e.key.path.rt(),a=ca(e.version);return s=e.hasCommittedMutations,new Bu(null,new zu(u,a),null,s,r,i)}if(e instanceof Fi){var c=e.key.path.rt(),h=ca(e.version);return new Bu(new Gu(c,h),null,null,!0,r,i)}return xr()}function ua(t){var e=t.G();return[e.seconds,e.nanoseconds]}function aa(t){var e=new ei(t[0],t[1]);return ni.j(e)}function ca(t){var e=t.G();return new Vu(e.seconds,e.nanoseconds)}function ha(t){var e=new ei(t.seconds,t.nanoseconds);return ni.j(e)}function fa(t,e){for(var n=(e.baseMutations||[]).map(function(e){return ru(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return ru(t.ks,e)}),s=ei.fromMillis(e.localWriteTimeMs);return new na(e.batchId,s,n,o)}function la(t){var e,n,r=ha(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ha(t.lastLimboFreeSnapshotVersion):ni.min();return void 0!==t.query.documents?(kr(1===(n=t.query).documents.length),e=bo(ho(Qs(n.documents[0])))):e=function(t){return bo(su(t))}(t.query),new jo(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ur.fromBase64String(t.resumeToken))}function pa(t,e){var n,r=ca(e.Mt),i=ca(e.lastLimboFreeSnapshotVersion);n=Ki(e.target)?iu(t.ks,e.target):ou(t.ks,e.target);var o=e.resumeToken.toBase64();return new Ku(e.targetId,Bi(e.target),r,o,e.sequenceNumber,i,n)}function da(t){var e=su({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?mo(e,e.limit,"L"):e}var va=function(){function t(){}return t.prototype.Ms=function(t,e){return ya(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ha(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return ya(t).put({bundleId:(n=e).id,createTime:ca(Hs(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return ga(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:da(e.bundledQuery),readTime:ha(e.readTime)};var e})},t.prototype.Bs=function(t,e){return ga(t).put(function(t){return{name:t.name,readTime:ca(Hs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ya(t){return ea(t,Qu.store)}function ga(t){return ea(t,$u.store)}var ba=function(){function t(){this.qs=new ma}return t.prototype.Us=function(t,e){return this.qs.add(e),mu.resolve()},t.prototype.Qs=function(t,e){return mu.resolve(this.qs.getEntries(e))},t}(),ma=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new ds(ii.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ds(ii.J)).rt()},t}(),wa=function(){function t(){this.Ks=new ma}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:Cu(i)};return Ia(t).put(o)}return mu.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Vr(e),""],!1,!0);return Ia(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ru(o.parent))}return n})},t}();function Ia(t){return ea(t,Xu.store)}var Oa={js:!1,Ws:0,Gs:0,zs:0},_a=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function Ea(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){if(t.code!==Mr.FAILED_PRECONDITION||t.message!==ku)throw t;return jr("LocalStore","Unexpectedly lost primary lease"),[2]})})}_a.Zs=10,_a.ti=1e3,_a.ei=new _a(41943040,_a.Zs,_a.ti),_a.ni=new _a(-1,0,0);var Ta=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ci(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return hi(this.ri)},t}(),ja=function(){function t(){this.oi=new Ta(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:ni.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?mu.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function Aa(t,e,n){var r=t.store(qu.store),i=t.store(Fu.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){kr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Fu.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return mu.$n(o).next(function(){return c})}function Na(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xr();e=t.noDocument}return JSON.stringify(e).length}var Sa=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return kr(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ka(t).ls({index:qu.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=Da(t),s=ka(t);return s.add({}).next(function(u){kr("number"==typeof u);for(var a=new na(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return nu(t.ks,e)}),i=n.mutations.map(function(e){return nu(t.ks,e)});return new qu(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new ds(function(t,e){return Lr(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Fu.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,Fu.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),mu.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return ka(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),fa(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?mu.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ka(t).ls({index:qu.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(kr(e.batchId>=r),o=fa(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ka(t).ls({index:qu.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ka(t).os(qu.userMutationsIndex,n).next(function(t){return t.map(function(t){return fa(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=Fu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Da(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=Ru(r[1]);if(u===n.userId&&e.path.isEqual(c))return ka(t).get(a).next(function(t){if(!t)throw xr();kr(t.userId===n.userId),o.push(fa(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new ds(Lr),i=[];return e.forEach(function(e){var o=Fu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Da(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=Ru(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),mu.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=Fu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new ds(Lr);return Da(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=Ru(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ka(t).get(e).next(function(t){if(null===t)throw xr();kr(t.userId===n.userId),r.push(fa(n.Kt,t))}))}),mu.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return Aa(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),mu.forEach(r,function(e){return n.Ii.Oi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return mu.resolve();var r=IDBKeyRange.lowerBound(Fu.prefixForUser(e.userId)),i=[];return Da(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=Ru(t[1]);i.push(o)}else r.done()}).next(function(){kr(0===i.length)})})},t.prototype.ki=function(t,e){return xa(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return Ca(t).get(this.userId).next(function(t){return t||new Mu(e.userId,-1,"")})},t}();function xa(t,e,n){var r=Fu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Da(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function ka(t){return ea(t,qu.store)}function Da(t){return ea(t,Fu.store)}function Ca(t){return ea(t,Mu.store)}var Pa=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),La=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new Pa(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return ni.j(new ei(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return Ra(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return kr(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return Ra(t).ls(function(s,u){var a=la(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return mu.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return Ra(t).ls(function(t,n){var r=la(n);e(r)})},t.prototype.Ui=function(t){return Va(t).get(Wu.key).next(function(t){return kr(null!==t),t})},t.prototype.Qi=function(t,e){return Va(t).put(Wu.key,e)},t.prototype.zi=function(t,e){return Ra(t).put(pa(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=Bi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ra(t).ls({range:r,index:Ku.queryTargetsIndexName},function(t,n,r){var o=la(n);Hi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=Ua(t);return e.forEach(function(e){var s=Cu(e.path);i.push(o.put(new Ju(n,s))),i.push(r.Ii.sr(t,n,e))}),mu.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=Ua(t);return mu.forEach(e,function(e){var o=Cu(e.path);return mu.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=Ua(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ua(t),i=Es();return r.ls({range:n,hs:!0},function(t,e,n){var r=Ru(t[1]),o=new ui(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=Cu(e.path),r=IDBKeyRange.bound([n],[Vr(n)],!1,!0),i=0;return Ua(t).ls({index:Ju.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return Ra(t).get(e).next(function(t){return t?la(t):null})},t}();function Ra(t){return ea(t,Ku.store)}function Va(t){return ea(t,Wu.store)}function Ua(t){return ea(t,Ju.store)}function Ma(t,e){var n=t[1],r=e[1],i=Lr(t[0],e[0]);return 0===i?Lr(n,r):i}var qa=function(){function t(t){this.ar=t,this.buffer=new ds(Ma),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ma(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Fa=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;jr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object(_r.b)(e,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return Eu(e=n.sent())?(jr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ea(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),za=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return mu.resolve(ti.U);var r=new qa(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(jr("LruGarbageCollector","Garbage collection skipped; disabled"),mu.resolve(Oa)):this.br(t).next(function(r){return r<n.params.Hs?(jr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),Oa):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(jr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),Tr()<=m.a.DEBUG&&jr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),mu.resolve({js:!0,Ws:r,Gs:i,zs:t})})},t}(),Ga=function(){function t(t,e){this.db=t,this._r=function(t,e){return new za(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return Ba(t,n)},t.prototype.rr=function(t,e,n){return Ba(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return Ba(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return Ca(t)._s(function(r){return xa(t,r,e).next(function(t){return t&&(n=!0),mu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),Ua(t).delete([0,Cu(s.path)])})});i.push(a)}}).next(function(){return mu.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return Ba(t,e)},t.prototype.Cr=function(t,e){var n,r=Ua(t),i=ti.U;return r.ls({index:Ju.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==ti.U&&e(new ui(Ru(n)),i),i=s,n=o):i=ti.U}).next(function(){i!==ti.U&&e(new ui(Ru(n)),i)})},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function Ba(t,e){return Ua(t).put(function(t,e){return new Ju(0,Cu(t.path),e)}(e,t.vs))}var Ha=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Wa(t).put(Xa(e),n)},t.prototype._i=function(t,e){var n=Wa(t),r=Xa(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Wa(t).get(Xa(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Wa(t).get(Xa(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:Na(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=bs();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=bs(),i=new fs(ui.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,Na(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return mu.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Wa(t).ls({range:r},function(t,e,r){for(var s=ui.Tt(t);o&&ui.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=ws(),o=e.path.length+1,s={};if(n.isEqual(ni.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=ua(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Bu.collectionReadTimeIndex}return Wa(t).ls(s,function(t,n,s){if(t.length===o){var u=oa(r.Kt,n);e.path.st(u.key.path)?u instanceof Mi&&_o(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Ka(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ja(t).get(Hu.key).next(function(t){return kr(!!t),t})},t.prototype.Lr=function(t,e){return Ja(t).put(Hu.key,e)},t.prototype.$r=function(t){if(t){var e=oa(this.Kt,t);return e instanceof qi&&e.version.isEqual(ni.min())?null:e}return null},t}(),Ka=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new Ta(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(_r.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new ds(function(t,e){return Lr(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=sa(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=Na(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.Wr){var h=sa(e.Gr.Kt,new qi(o,ni.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),mu.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(ja);function Ja(t){return ea(t,Hu.store)}function Wa(t){return ea(t,Bu.store)}function Xa(t){return t.path.rt()}var Ya=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;kr(n<r&&n>=0&&r<=11);var o=new wu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Uu.store)}(t),function(t){t.createObjectStore(Mu.store,{keyPath:Mu.keyPath}),t.createObjectStore(qu.store,{keyPath:qu.keyPath,autoIncrement:!0}).createIndex(qu.userMutationsIndex,qu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Fu.store)}(t),Qa(t),function(t){t.createObjectStore(Bu.store)}(t));var s=mu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ju.store),t.deleteObjectStore(Ku.store),t.deleteObjectStore(Wu.store)}(t),Qa(t)),s=s.next(function(){return function(t){var e=t.store(Wu.store),n=new Wu(0,0,ni.min().G(),0);return e.put(Wu.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(qu.store).os().next(function(n){t.deleteObjectStore(qu.store),t.createObjectStore(qu.store,{keyPath:qu.keyPath,autoIncrement:!0}).createIndex(qu.userMutationsIndex,qu.userMutationsKeyPath,{unique:!0});var r=e.store(qu.store),i=n.map(function(t){return r.put(t)});return mu.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Yu.store,{keyPath:Yu.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Hu.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Bu.store);e.createIndex(Bu.readTimeIndex,Bu.readTimeIndexPath,{unique:!1}),e.createIndex(Bu.collectionReadTimeIndex,Bu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Qu.store,{keyPath:Qu.keyPath})}(t),function(t){t.createObjectStore($u.store,{keyPath:$u.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store(Bu.store).ls(function(t,n){e+=Na(n)}).next(function(){var n=new Hu(e);return t.store(Hu.store).put(Hu.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(Mu.store),r=t.store(qu.store);return n.os().next(function(n){return mu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(qu.userMutationsIndex,i).next(function(r){return mu.forEach(r,function(r){kr(r.userId===n.userId);var i=fa(e.Kt,r);return Aa(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(Ju.store),n=t.store(Bu.store);return t.store(Wu.store).get(Wu.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new ii(n),s=function(t){return[0,Cu(t)]}(o);r.push(e.get(s).next(function(n){return n?mu.resolve():function(n){return e.put(new Ju(0,Cu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return mu.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(Xu.store,{keyPath:Xu.keyPath});var n=e.store(Xu.store),r=new ma,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:Cu(i)})}};return e.store(Bu.store).ls({hs:!0},function(t,e){var n=new ii(t);return i(n.Z())}).next(function(){return e.store(Fu.store).ls({hs:!0},function(t,e){var n=Ru(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(Ku.store);return n.ls(function(t,r){var i=la(r),o=pa(e.Kt,i);return n.put(o)})},t}();function Qa(t){t.createObjectStore(Ju.store,{keyPath:Ju.keyPath}).createIndex(Ju.documentTargetsIndex,Ju.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ku.store,{keyPath:Ku.keyPath}).createIndex(Ku.queryTargetsIndexName,Ku.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Wu.store)}var $a="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Za=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new qr(Mr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Ga(this,i),this.lo=n+"main",this.Kt=new ia(a),this._o=new Iu(this.lo,11,new Ya(this.Kt)),this.fo=new La(this.Ii,this.Kt),this.Ti=new wa,this.wo=function(t,e){return new Ha(t,e)}(this.Kt,this.Ti),this.Eo=new va,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new qr(Mr.FAILED_PRECONDITION,$a);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.ji(e)})}).then(function(e){t.io=new ti(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object(_r.b)(e,void 0,void 0,function(){return Object(_r.d)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object(_r.b)(e,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object(_r.b)(e,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ec(e).put(new Yu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(Eu(e))return jr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return jr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return tc(t).get(Uu.key).next(function(t){return mu.resolve(e.Co(t))})},t.prototype.xo=function(t){return ec(t).delete(this.clientId)},t.prototype.No=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(_r.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=ea(t,Yu.store);return e.os().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return mu.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?mu.resolve(!0):tc(t).get(Uu.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new qr(Mr.FAILED_PRECONDITION,$a);return!1}}return!(!e.networkEnabled||!e.inForeground)||ec(t).os().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&jr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object(_r.b)(this,void 0,void 0,function(){var t=this;return Object(_r.d)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Uu.store,Yu.store],function(e){var n=new ta(e,ti.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ec(e).os().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return Sa.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return jr("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",Zu,function(o){return r=new ta(o,i.io?i.io.next():ti.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw Ar("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new qr(Mr.FAILED_PRECONDITION,ku);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return tc(t).get(Uu.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new qr(Mr.FAILED_PRECONDITION,$a)})},t.prototype.Do=function(t){var e=new Uu(this.clientId,this.allowTabSynchronization,Date.now());return tc(t).put(Uu.key,e)},t.jn=function(){return Iu.jn()},t.prototype.So=function(t){var e=this,n=tc(t);return n.get(Uu.key).next(function(t){return e.Co(t)?(jr("IndexedDbPersistence","Releasing primary lease."),n.delete(Uu.key)):mu.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return jr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function tc(t){return ea(t,Uu.store)}function ec(t){return ea(t,Yu.store)}function nc(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var rc=function(t,e){this.progress=t,this.zo=e},ic=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=bs();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=gs();return i.forEach(function(t,e){e||(e=new qi(t,ni.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return ui.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):yo(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new ui(e)).next(function(t){var e=ws();return t instanceof Mi&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=ws();return this.Ti.Qs(t,i).next(function(s){return mu.forEach(s,function(s){var u=function(t,e){return new ao(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Wo(a,r.get(c),0,o.Ss);r=h instanceof Mi?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){_o(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=Es(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Zo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Mi&&(c=c.Ht(t,e))}),c})},t}(),oc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=Es(),i=Es(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),sc=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(ni.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(fo(e)||lo(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(Tr()<=m.a.DEBUG&&jr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Oo(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new ds(Eo(t));return e.forEach(function(e,r){r instanceof Mi&&_o(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return Tr()<=m.a.DEBUG&&jr("QueryEngine","Using full collection scan to execute query:",Oo(e)),this.uc.jr(t,e,ni.min())},t}(),uc=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new fs(Lr),this.wc=new Ta(function(t){return Bi(t)},Hi),this.Ec=ni.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new ic(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function ac(t,e,n,r){return new uc(t,e,n,r)}function cc(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(_r.d)(this,function(s){switch(s.label){case 0:return n=Dr(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new ic(n.Tc,r,n.persistence.jo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=Es(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function hc(t,e){var n=Dr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=mu.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);kr(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function fc(t){var e=Dr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function lc(t,e){var n=Dr(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return kr(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=gs();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(pc(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(ni.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.Wi(t,t.vs,r)});s.push(a)}return mu.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function pc(t,e,n,r,i){var o=Es();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=gs();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof qi&&s.version.isEqual(ni.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):jr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function dc(t,e){var n=Dr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function vc(t,e){var n=Dr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?mu.resolve(r=i):n.fo.qi(t).next(function(i){return r=new jo(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function yc(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:r=Dr(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Eu(s=u.sent()))throw s;return jr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function gc(t,e,n){var r=Dr(t),i=ni.min(),o=Es();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Dr(t),i=r.wc.get(n);return void 0!==i?mu.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,bo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:ni.min(),n?o:Es())}).next(function(t){return{documents:t,Pc:o}})})}function bc(t,e){var n=Dr(t),r=Dr(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function mc(t){var e=Dr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Dr(t),i=gs(),o=ua(n),s=Wa(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Bu.readTimeIndex,range:u},function(t,e){var n=oa(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:aa(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function wc(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){return[2,(e=Dr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Wa(t),n=ni.min();return e.ls({index:Bu.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=aa(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function Ic(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(_r.d)(this,function(d){switch(d.label){case 0:for(i=Dr(t),o=Es(),s=gs(),u=Os(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,vc(i,function(t){return bo(ho(ii.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return pc(t,l,s,ni.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function Oc(t,e,n){return void 0===n&&(n=Es()),Object(_r.b)(this,void 0,void 0,function(){var r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return[4,vc(t,bo(da(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Dr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Hs(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(Ur.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var _c=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return mu.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Hs(n.createTime)}),mu.resolve()},t.prototype.$s=function(t,e){return mu.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:da(t.bundledQuery),readTime:Hs(t.readTime)}}(e)),mu.resolve()},t}(),Ec=function(){function t(){this.Sc=new ds(Tc.Dc),this.Cc=new ds(Tc.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new Tc(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Oc(new Tc(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new ui(new ii([])),r=new Tc(n,t),i=new Tc(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Oc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Oc(e)})},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new ui(new ii([])),n=new Tc(e,t),r=new Tc(e,t+1),i=Es();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new Tc(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),Tc=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return ui.J(t.key,e.key)||Lr(t.$c,e.$c)},t.xc=function(t,e){return Lr(t.$c,e.$c)||ui.J(t.key,e.key)},t}(),jc=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new ds(Tc.Dc)}return t.prototype.Ri=function(t){return mu.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new na(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new Tc(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return mu.resolve(o)},t.prototype.yi=function(t,e){return mu.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return mu.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return mu.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return mu.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new Tc(e,0),i=new Tc(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),mu.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new ds(Lr);return e.forEach(function(t){var e=new Tc(t,0),i=new Tc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),mu.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;ui.Et(i)||(i=i.child(""));var o=new Tc(new ui(i),0),s=new ds(Lr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),mu.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;kr(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return mu.forEach(e.mutations,function(i){var o=new Tc(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new Tc(e,0),r=this.qc.Pe(n);return mu.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return mu.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),Ac=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new fs(ui.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return mu.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=bs();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),mu.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=ws(),i=new ui(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof Mi&&_o(e,a)&&(r=r.Ht(a.key,a))}return mu.resolve(r)},t.prototype.Gc=function(t,e){return mu.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new Nc(this)},t.prototype.Mr=function(t){return mu.resolve(this.size)},t}(),Nc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object(_r.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),mu.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(ja),Sc=function(){function t(t){this.persistence=t,this.zc=new Ta(function(t){return Bi(t)},Hi),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Ec,this.targetCount=0,this.Yc=Pa.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),mu.resolve()},t.prototype.Ki=function(t){return mu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return mu.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),mu.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),mu.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Pa(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,mu.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),mu.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,mu.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),mu.$n(o).next(function(){return i})},t.prototype.tr=function(t){return mu.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return mu.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),mu.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),mu.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),mu.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return mu.resolve(n)},t.prototype.ki=function(t,e){return mu.resolve(this.Jc.ki(e))},t}(),xc=function(){function t(t,e){var n=this;this.Xc={},this.io=new ti(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Sc(this),this.Ti=new ba,this.wo=function(t,e){return new Ac(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new ia(e),this.Eo=new _c(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new jc(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;jr("MemoryPersistence","Starting transaction:",t);var i=new kc(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return mu.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),kc=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object(_r.c)(e,t),e}(Du),Dc=function(){function t(t){this.persistence=t,this.sa=new Ec,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw xr()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),mu.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),mu.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),mu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return mu.forEach(this.oa,function(r){var i=ui.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return mu.Bn([function(){return mu.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function Cc(t,e){return"firestore_clients_"+t+"_"+e}function Pc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function Lc(t,e){return"firestore_targets_"+t+"_"+e}var Rc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new qr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Ar("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Vc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new qr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Ar("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Uc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=js(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ii(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Ar("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Mc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ar("SharedClientState","Failed to parse online state: "+e),null)},t}(),qc=function(){function t(){this.activeTargetIds=js()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Fc=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new fs(Lr),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=Cc(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new qc),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(_r.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(Cc(this.persistenceKey,r)))&&(o=Uc.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(Lc(this.persistenceKey,t));if(n){var r=Vc.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(Lc(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return jr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){jr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){jr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(jr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object(_r.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(_r.d)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=ti.U;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ti.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Rc(this.currentUser,t,e,n),i=Pc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=Pc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=Lc(this.persistenceKey,t),i=new Vc(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return Uc.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Rc.aa(new Wr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return Vc.aa(r,e)},t.prototype.ba=function(t){return Mc.aa(t)},t.prototype.Xa=function(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(jr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=js();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),zc=function(){function t(){this.ru=new qc,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new qc,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),Gc=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),Bc=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){jr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){jr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Hc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Kc=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Jc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(_r.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new Or;s.listenOnce(mr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case br.NO_ERROR:var e=s.getResponseJson();jr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case br.TIMEOUT:jr("Connection",'RPC "'+t+'" timed out'),o(new qr(Mr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var n=s.getStatus();if(jr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Mr).indexOf(e)>=0?e:Mr.UNKNOWN}(r.status);o(new qr(u,r.message))}else o(new qr(Mr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new qr(Mr.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{jr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new pr,i=ve(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(w.l)()||Object(w.n)()||Object(w.j)()||Object(w.k)()||Object(w.o)()||Object(w.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");jr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Kc({du:function(t){c?jr("Connection","Not sending because WebChannel is closed:",t):(a||(jr("Connection","Opening WebChannel transport."),u.open(),a=!0),jr("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Ir.EventType.OPEN,function(){c||jr("Connection","WebChannel transport opened.")}),f(u,Ir.EventType.CLOSE,function(){c||(c=!0,jr("Connection","WebChannel transport closed"),h.Pu())}),f(u,Ir.EventType.ERROR,function(t){c||(c=!0,Nr("Connection","WebChannel transport errored:",t),h.Pu(new qr(Mr.UNAVAILABLE,"The operation could not be completed")))}),f(u,Ir.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];kr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){jr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=is[t];if(void 0!==e)return hs(e)}(i),s=r.message;void 0===o&&(o=Mr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new qr(o,s)),u.close()}else jr("Connection","WebChannel received:",n),h.yu(n)}}),f(i,wr.STAT_EVENT,function(t){10===t.stat?jr("Connection","Detected buffering proxy"):11===t.stat&&jr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);jr("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return jr("RestConnection","Received: ",t),t},function(e){throw Nr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+Hc[t]},t}());function Wc(){return"undefined"!=typeof window?window:null}function Xc(){return"undefined"!=typeof document?document:null}function Yc(t){return new Fs(t,!0)}var Qc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&jr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),$c=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new Qc(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===Mr.RESOURCE_EXHAUSTED?(Ar(e.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===Mr.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then(function(e){t.Wu===n&&t.rh(e)},function(n){e(function(){var e=new qr(Mr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(_r.b)(t,void 0,void 0,function(){return Object(_r.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return jr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.Wu===t?n():(jr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Zc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(_r.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:xr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(kr(void 0===e||"string"==typeof e),Ur.fromBase64String(e||"")):(kr(void 0===e||e instanceof Uint8Array),Ur.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?Mr.UNKNOWN:hs(t.code);return new qr(e,t.message||"")}(u);n=new Ps(r,i,o,s||null)}else if("documentChange"in e){i=Xs(t,(r=e.documentChange).document.name),o=Hs(r.document.updateTime);var u=new Li({mapValue:{fields:r.document.fields}}),a=(s=new Mi(i,o,u,{}),r.targetIds||[]);n=new Ds(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Xs(t,(r=e.documentDelete).document),o=r.readTime?Hs(r.readTime):ni.min(),u=new qi(i,o),n=new Ds([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=Xs(t,(r=e.documentRemove).document),n=new Ds([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return xr();var c=e.filter;i=new as(r=c.count||0),n=new Cs(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return ni.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ni.min():e.readTime?Hs(e.readTime):ni.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=$s(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Ki(r)?{documents:iu(t,r)}:{query:ou(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Gs(t,e.resumeToken):e.Mt.u(ni.min())>0&&(n.readTime=zs(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=$s(this.Kt),e.removeTarget=t,this.eh(e)},e}($c),th=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(kr(void 0!==e),t.map(function(t){return function(t,e){var n=Hs(t.updateTime?t.updateTime:e);n.isEqual(ni.min())&&(n=Hs(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Go(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Hs(t.commitTime);return this.listener.wh(n,e)}return kr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=$s(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return nu(e.Kt,t)})};this.eh(n)},e}($c),eh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(_r.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new qr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),nh=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Ar(e),this.Ph=!1):jr("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),rh=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(_r.b)(o,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return lh(this)?(jr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return(e=Dr(t)).Oh.add(4),[4,oh(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,ih(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new nh(n,r)};function ih(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:if(!lh(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oh(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sh(t,e){var n=Dr(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),fh(n)?hh(n):Ah(n).Ju()&&ah(n,e))}function uh(t,e){var n=Dr(t),r=Ah(n);n.Nh.delete(e),r.Ju()&&ch(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():lh(n)&&n.Mh.set("Unknown"))}function ah(t,e){t.Lh.cn(e.targetId),Ah(t).hh(e)}function ch(t,e){t.Lh.cn(e),Ah(t).lh(e)}function hh(t){t.Lh=new Rs({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),Ah(t).start(),t.Mh.yh()}function fh(t){return lh(t)&&!Ah(t).Hu()&&t.Nh.size>0}function lh(t){return 0===Dr(t).Oh.size}function ph(t){t.Lh=void 0}function dh(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){return t.Nh.forEach(function(e,n){ah(t,e)}),[2]})})}function vh(t,e){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(n){return ph(t),fh(t)?(t.Mh.ph(e),hh(t)):t.Mh.set("Unknown"),[2]})})}function yh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o;return Object(_r.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof Ps&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(_r.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),jr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,gh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ds?t.Lh.wn(e):e instanceof Cs?t.Lh.yn(e):t.Lh.In(e),n.isEqual(ni.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,fc(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(Ur.h,n.Mt)),ch(t,e);var r=new jo(n.target,e,1,n.sequenceNumber);ah(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return jr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,gh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function gh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r=this;return Object(_r.d)(this,function(i){switch(i.label){case 0:if(!Eu(e))throw e;return t.Oh.add(1),[4,oh(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return fc(t.Sh)}),t.fs.bo(function(){return Object(_r.b)(r,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return jr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,ih(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function bh(t,e){return e().catch(function(n){return gh(t,n,e)})}function mh(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(_r.d)(this,function(s){switch(s.label){case 0:e=Dr(t),n=Nh(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return lh(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,dc(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=Nh(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,gh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return wh(e)&&Ih(e),[2]}})})}function wh(t){return lh(t)&&!Nh(t).Hu()&&t.xh.length>0}function Ih(t){Nh(t).start()}function Oh(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){return Nh(t).Th(),[2]})})}function _h(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n,r;return Object(_r.d)(this,function(i){for(e=Nh(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function Eh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=ra.from(r,e,n),[4,bh(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,mh(t)];case 2:return o.sent(),[2]}})})}function Th(t,e){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(n){switch(n.label){case 0:return e&&Nh(t).fh?[4,function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:return cs(r=e.code)&&r!==Mr.ABORTED?(n=t.xh.shift(),Nh(t).Xu(),[4,bh(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,mh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return wh(t)&&Ih(t),[2]}})})}function jh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n;return Object(_r.d)(this,function(r){switch(r.label){case 0:return n=Dr(t),e?(n.Oh.delete(2),[4,ih(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,oh(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Ah(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Dr(t);return r.mh(),new Zc(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:dh.bind(null,t),Iu:vh.bind(null,t),uh:yh.bind(null,t)}),t.Fh.push(function(n){return Object(_r.b)(e,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),fh(t)?hh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),ph(t),e.label=3;case 3:return[2]}})})})),t.Qh}function Nh(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=Dr(t);return r.mh(),new th(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Oh.bind(null,t),Iu:Th.bind(null,t),Eh:_h.bind(null,t),wh:Eh.bind(null,t)}),t.Fh.push(function(n){return Object(_r.b)(e,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,mh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(jr("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var Sh=function(){this.jh=void 0,this.listeners=[]},xh=function(){this.queries=new Ta(function(t){return Io(t)},wo),this.onlineState="Unknown",this.Wh=new Set};function kh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(_r.d)(this,function(c){switch(c.label){case 0:if(n=Dr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Sh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return u=c.sent(),a=xu(u,"Initialization of query '"+Oo(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&Lh(n),[2]}})})}function Dh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(_r.d)(this,function(u){return n=Dr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function Ch(t,e){for(var n=Dr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&Lh(n)}function Ph(t,e,n){var r=Dr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Lh(t){t.Wh.forEach(function(t){t.next()})}var Rh=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ss(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=Ss.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),Vh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),Uh=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return Xs(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?eu(this.Kt,t.document,!1):new qi(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Hs(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new Uh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Es()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return[4,Ic(this.Sh,new Uh(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Oc(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new rc(Object.assign({},this.progress),t))]}})})}}();var Mh=function(t){this.key=t},qh=function(t){this.key=t},Fh=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=Es(),this.Ce=Es(),this.ll=Eo(t),this._l=new As(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new Ns,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=fo(this.query)&&i.size===this.query.limit?i.last():null,c=lo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof Mi?e:null;f&&(f=_o(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),fo(this.query)||lo(this.query))for(;s.size>this.query.limit;){var h=fo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new Ss(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new Ns,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=Es(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new qh(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Mh(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=Es();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return Ss.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),zh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Gh=function(t){this.key=t,this.yl=!1},Bh=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Ta(function(t){return Io(t)},wo),this.Dl=new Map,this.Cl=[],this.xl=new fs(ui.J),this.Nl=new Map,this.Ol=new Ec,this.Fl={},this.kl=new Map,this.Ml=Pa.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Hh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:return n=If(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,vc(n.Sh,bo(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,Kh(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&sh(n.gl,o),u.label=4;case 4:return[2,r]}})})}function Kh(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(_r.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,gc(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(sf(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,gc(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Fh(e,i.Pc),s=o.dl(i.documents),u=ks.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),sf(t,n,a.ml),c=new zh(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Jh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return n=Dr(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!wo(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,yc(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),uh(n.gl,r.targetId),rf(n,r.targetId)}).catch(Ea)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return rf(n,r.targetId),[4,yc(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Wh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:r=Of(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Dr(t),i=ei.now(),o=e.reduce(function(t,e){return t.add(e.key)},Es());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Xo(c,n.get(c.key));null!=h&&s.push(new Zo(c.key,h,Vi(h.proto.mapValue),Bo.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new fs(Lr)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,cf(r,i.oi)];case 3:return u.sent(),[4,mh(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=xu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Xh(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:n=Dr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,lc(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.Nl.get(e);r&&(kr(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?kr(r.yl):t.Ke.size>0&&(kr(r.yl),r.yl=!1))}),[4,cf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ea(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Yh(t,e,n){var r=Dr(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Dr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&Lh(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Qh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(_r.d)(this,function(c){switch(c.label){case 0:return(r=Dr(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new fs(ui.J)).Ht(o,new qi(o,ni.min())),u=Es().add(o),a=new xs(ni.min(),new Map,new ds(Lr),s,u),[4,Xh(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),af(r),[3,4];case 2:return[4,yc(r.Sh,e,!1).then(function(){return rf(r,e,n)}).catch(Ea)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function $h(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:n=Dr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,hc(n.Sh,e)];case 2:return i=o.sent(),nf(n,r,null),ef(n,r),n.pl.Oa(r,"acknowledged"),[4,cf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ea(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Zh(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:r=Dr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Dr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return kr(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),nf(r,e,n),ef(r,e),r.pl.Oa(e,"rejected",n),[4,cf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ea(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function tf(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:lh((n=Dr(t)).gl)||jr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Dr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=xu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function ef(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function nf(t,e,n){var r=Dr(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function rf(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach(function(e){t.Ol.ki(e)||of(t,e)})}function of(t,e){var n=t.xl.get(e);null!==n&&(uh(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),af(t))}function sf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Mh?(t.Ol.sr(o.key,e),uf(t,o)):o instanceof qh?(jr("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||of(t,o.key)):xr()}}function uf(t,e){var n=e.key;t.xl.get(n)||(jr("SyncEngine","New document in limbo: "+n),t.Cl.push(n),af(t))}function af(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Gh(e)),t.xl=t.xl.Ht(e,n),sh(t.gl,new jo(bo(ho(e.path)),n,2,ti.U))}}function cf(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:return r=Dr(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=oc.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(_r.d)(this,function(h){switch(h.label){case 0:n=Dr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return mu.forEach(e,function(e){return mu.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return mu.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Eu(r=h.sent()))throw r;return jr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function hf(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:return(n=Dr(t)).currentUser.isEqual(e)?[3,3]:(jr("SyncEngine","User change. New user:",e.R()),[4,cc(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new qr(Mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,cf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function ff(t,e){var n=Dr(t),r=n.Nl.get(e);if(r&&r.yl)return Es().add(r.key);var i=Es(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function lf(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return[4,gc((n=Dr(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&sf(n,e.targetId,i.ml),i)]}})})}function pf(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){return[2,mc((e=Dr(t)).Sh).then(function(t){return cf(e,t)})]})})}function df(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o;return Object(_r.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Dr(t),r=Dr(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):mu.resolve(null)})})}((i=Dr(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,mh(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(nf(i,e,r||null),ef(i,e),function(t,e){Dr(Dr(t).Ho).Ni(e)}(i.Sh,e)):xr(),s.label=4;case 4:return[4,cf(i,o)];case 5:return s.sent(),[3,7];case 6:jr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function vf(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(_r.d)(this,function(c){switch(c.label){case 0:return If(n=Dr(t)),Of(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,yf(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,jh(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)sh(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return rf(n,e),yc(n.Sh,e,!0)}),uh(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,yf(n,u)];case 5:return c.sent(),function(t){var e=Dr(t);e.Nl.forEach(function(t,n){uh(e.gl,n)}),e.Ol.Mc(),e.Nl=new Map,e.xl=new fs(ui.J)}(n),n.Ll=!1,[4,jh(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function yf(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(_r.d)(this,function(v){switch(v.label){case 0:n=Dr(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,vc(n.Sh,bo(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,lf(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,bc(n.Sh,u)];case 8:return d=v.sent(),[4,vc(n.Sh,d)];case 9:return a=v.sent(),[4,Kh(n,gf(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function gf(t){return co(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function bf(t){var e=Dr(t);return Dr(Dr(e.Sh).persistence).Qo()}function mf(t,e,n,r){return Object(_r.b)(this,void 0,void 0,function(){var i,o,s;return Object(_r.d)(this,function(u){switch(u.label){case 0:return(i=Dr(t)).Ll?(jr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,mc(i.Sh)];case 3:return o=u.sent(),s=xs.$e(e,"current"===n),[4,cf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,yc(i.Sh,e,!0)];case 6:return u.sent(),rf(i,e,r),[3,8];case 7:xr(),u.label=8;case 8:return[2]}})})}function wf(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(_r.d)(this,function(l){switch(l.label){case 0:if(!(r=If(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(jr("SyncEngine","Adding an already active target "+s),[3,5]):[4,bc(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,vc(r.Sh,u)];case 3:return a=l.sent(),[4,Kh(r,gf(u),a.targetId,!1)];case 4:l.sent(),sh(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(_r.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,yc(r.Sh,t,!1).then(function(){uh(r.gl,t),rf(r,t)}).catch(Ea)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function If(t){var e=Dr(t);return e.gl.Ch.Bh=Xh.bind(null,e),e.gl.Ch.Sn=ff.bind(null,e),e.gl.Ch.$h=Qh.bind(null,e),e.vl.uh=Ch.bind(null,e.Vl),e.vl.ql=Ph.bind(null,e.Vl),e}function Of(t){var e=Dr(t);return e.gl.Ch.qh=$h.bind(null,e),e.gl.Ch.Uh=Zh.bind(null,e),e}var _f=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return this.Kt=Yc(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return ac(this.persistence,new sc,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new xc(Dc.ra,this.Kt)},t.prototype.Wl=function(t){return new zc},t.prototype.terminate=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),Ef=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(_r.c)(e,t),e.prototype.initialize=function(e){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,wc(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Of(this.Xl.fa)];case 4:return n.sent(),[4,mh(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return ac(this.persistence,new sc,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new Fa(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=nc(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?_a.Xs(this.cacheSizeBytes):_a.ei;return new Za(this.synchronizeTabs,e,t.clientId,n,t.fs,Wc(),Xc(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new zc},e}(_f),Tf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(_r.c)(e,t),e.prototype.initialize=function(e){return Object(_r.b)(this,void 0,void 0,function(){var n,r=this;return Object(_r.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Fc?(this.pl.fa={nu:df.bind(null,n),su:mf.bind(null,n),iu:wf.bind(null,n),Qo:bf.bind(null,n),eu:pf.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object(_r.b)(r,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return[4,vf(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=Wc();if(!Fc.jn(e))throw new qr(Mr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=nc(t.gu.T,t.gu.persistenceKey);return new Fc(e,t.fs,n,t.clientId,t.Yl)},e}(Ef),jf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n=this;return Object(_r.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Yh(n.fa,t,1)},this.gl.Ch.s_=hf.bind(null,this.fa),[4,jh(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new xh},t.prototype.Zl=function(t){var e=Yc(t.gu.T),n=new Jc(t.gu);return function(t,e,n){return new eh(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Yh(s.fa,t,0)},o=Bc.jn()?new Bc:new Gc,new rh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Bh(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return e=Dr(t),jr("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,oh(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),Af=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Nf=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new bu,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new Vh(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qr(Mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new si(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),Sf=function(t){this._methodName=t};function xf(t,e,n){if(!n)throw new qr(Mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function kf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(Mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Df(t,e,n,r){if(!0===e&&!0===r)throw new qr(Mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Cf(t){if(!ui.Et(t))throw new qr(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Pf(t){if(ui.Et(t))throw new qr(Mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Lf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":xr()}function Rf(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new qr(Mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Lf(t);throw new qr(Mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Vf(t,e){if(e<=0)throw new qr(Mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qr(Mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qr(Mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Df("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Mf=new Map,qf=function(){function t(t,e){this.w_="(lite)",this.E_=new Uf({}),this.T_=!1,t instanceof Jr?(this.I_=t,this.m_=new Yr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qr(Mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jr(t.options.projectId)}(t),this.m_=new Qr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new qr(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new qr(Mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Uf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Yr;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(Mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=Mf.get(this))&&(jr("ComponentProvider","Removing Datastore"),Mf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Ff=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Gf(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),zf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Gf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ho(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Ff(this.firestore,null,new ui(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(zf);function Bf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),xf("collection","path",e),t instanceof qf)return Pf(n=ii.ct.apply(ii,Object(_r.g)([e],r))),new Gf(t,null,n);if(!(t instanceof Ff||t instanceof Gf))throw new qr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Pf(n=ii.ct.apply(ii,Object(_r.g)([t.path],r)).child(ii.ct(e))),new Gf(t.firestore,null,n)}function Hf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),1===arguments.length&&(e=Pr.t()),xf("doc","path",e),t instanceof qf)return Cf(n=ii.ct.apply(ii,Object(_r.g)([e],r))),new Ff(t,null,new ui(n));if(!(t instanceof Ff||t instanceof Gf))throw new qr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Cf(n=t.D_.child(ii.ct.apply(ii,Object(_r.g)([e],r)))),new Ff(t.firestore,t instanceof Gf?t.v_:null,new ui(n))}function Kf(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),(t instanceof Ff||t instanceof Gf)&&(e instanceof Ff||e instanceof Gf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Jf(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),t instanceof zf&&e instanceof zf&&t.firestore===e.firestore&&wo(t.C_,e.C_)&&t.v_===e.v_}var Wf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new qr(Mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new qr(Mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return Lr(this.x_,t.x_)||Lr(this.N_,t.N_)},t}(),Xf=/^__.*__$/,Yf=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new Zo(t,this.data,this.zt,e,this.fieldTransforms):new $o(t,this.data,e,this.fieldTransforms)},t}(),Qf=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new Zo(t,this.data,this.zt,e,this.fieldTransforms)},t}();function $f(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xr()}}var Zf=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return ml(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if($f(this.k_)&&Xf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),tl=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Yc(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Zf({k_:t,methodName:e,W_:n,path:si.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function el(t){var e=t.p_(),n=Yc(t.I_);return new tl(t.I_,!!e.ignoreUndefinedProperties,n)}function nl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);vl("Data must be an object, but it was:",s,r);var u,a,c=pl(r,s);if(o.merge)u=new fi(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=yl(e,l[f],n);if(!s.contains(p))throw new qr(Mr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");wl(h,p)||h.push(p)}u=new fi(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Yf(new Li(c),u,a)}var rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Sf);function il(t,e,n){return new Zf({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var ol=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.z_=function(t){return new zo(t.path,new Po)},e.prototype.isEqual=function(t){return t instanceof e},e}(Sf),sl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(_r.c)(e,t),e.prototype.z_=function(t){var e=il(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),r=new Lo(n);return new zo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sf),ul=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(_r.c)(e,t),e.prototype.z_=function(t){var e=il(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),r=new Vo(n);return new zo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sf),al=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(_r.c)(e,t),e.prototype.z_=function(t){var e=new Mo(t.Kt,So(t.Kt,this.J_));return new zo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Sf);function cl(t,e,n,r){var i=t.G_(1,e,n);vl("Data must be an object, but it was:",i,r);var o=[],s=new Ri;ci(r,function(t,r){var u=bl(e,t,n);r instanceof zr&&(r=r._);var a=i.U_(u);if(r instanceof rl)o.push(u);else{var c=ll(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new fi(o);return new Qf(s.yt(),u,i.fieldTransforms)}function hl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[yl(e,r,n)],a=[i];if(o.length%2!=0)throw new qr(Mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(yl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ri,l=u.length-1;l>=0;--l)if(!wl(h,u[l])){var p=u[l],d=a[l];d instanceof zr&&(d=d._);var v=s.U_(p);if(d instanceof rl)h.push(p);else{var y=ll(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new fi(h);return new Qf(f.yt(),g,s.fieldTransforms)}function fl(t,e,n,r){return void 0===r&&(r=!1),ll(n,t.G_(r?4:3,e))}function ll(t,e){if(t instanceof zr&&(t=t._),dl(t))return vl("Unsupported field value:",e,t),pl(t,e);if(t instanceof Sf)return function(t,e){if(!$f(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ll(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof zr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return So(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:zs(e.Kt,n)}}if(t instanceof ei)return n=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:zs(e.Kt,n)};if(t instanceof Wf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fr)return{bytesValue:Gs(e.Kt,t.l)};if(t instanceof Ff){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ks(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Lf(t))}(t,e)}function pl(t,e){var n={};return hi(t)?e.path&&e.path.length>0&&e.zt.push(e.path):ci(t,function(t,r){var i=ll(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function dl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Wf||t instanceof Fr||t instanceof Ff||t instanceof Sf)}function vl(t,e,n){if(!dl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Lf(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function yl(t,e,n){if(e instanceof zr&&(e=e._),e instanceof Nf)return e.d_;if("string"==typeof e)return bl(t,e);throw ml("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var gl=new RegExp("[~\\*/\\[\\]]");function bl(t,e,n){if(e.search(gl)>=0)throw ml("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Nf.bind.apply(Nf,Object(_r.g)([void 0],e.split("."))))).d_}catch(r){throw ml("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ml(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new qr(Mr.INVALID_ARGUMENT,(u+=". ")+t+a)}function wl(t,e){return t.some(function(t){return t.isEqual(e)})}var Il=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n=this;return Object(_r.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new qr(Mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(_r.d)(this,function(a){switch(a.label){case 0:return n=Dr(t),r=$s(n.Kt)+"/documents",i={documents:e.map(function(t){return Ws(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){kr(!!e.found);var n=Xs(t,e.found.name),r=Hs(e.found.updateTime),i=new Li({mapValue:{fields:e.found.fields}});return new Mi(n,r,i,{})}(t,e):"missing"in e?function(t,e){kr(!!e.missing),kr(!!e.readTime);var n=Xs(t,e.missing),r=Hs(e.readTime);return new qi(n,r)}(t,e):xr()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());kr(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof qi||t instanceof Mi?n.sf(t):xr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new ss(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e=this;return Object(_r.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=ui.ft(n);e.mutations.push(new us(r,e.Gt(r)))}),[4,function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return n=Dr(t),r=$s(n.Kt)+"/documents",i={writes:e.map(function(t){return nu(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Mi)e=t.version;else{if(!(t instanceof qi))throw xr();e=ni.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qr(Mr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Bo.updateTime(e):Bo.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(ni.min()))throw new qr(Mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bo.updateTime(e)}return Bo.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Ol=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Qc(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(_r.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(_r.d)(this,function(r){return t=new Il(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!mi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!cs(e)}return!1},t}(),_l=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Wr.UNAUTHENTICATED,this.clientId=Pr.t(),this._f=function(){},this.N=new bu,this.credentials.S(function(t){jr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new qr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new bu;return this.fs.Tf(function(){return Object(_r.b)(t,void 0,void 0,function(){var t,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=xu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function El(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(_r.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),jr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object(_r.b)(i,void 0,void 0,function(){return Object(_r.d)(this,function(t){switch(t.label){case 0:return[4,cc(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function Tl(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,jl(t)];case 1:return n=i.sent(),jr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object(_r.b)(this,void 0,void 0,function(){var n,r;return Object(_r.d)(this,function(i){switch(i.label){case 0:return(n=Dr(t)).fs.Af(),jr("RemoteStore","RemoteStore received new credentials"),r=lh(n),n.Oh.add(3),[4,oh(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,ih(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function jl(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(jr("FirestoreClient","Using default OfflineComponentProvider"),[4,El(t,new _f)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Al(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(jr("FirestoreClient","Using default OnlineComponentProvider"),[4,Tl(t,new jf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function Nl(t){return jl(t).then(function(t){return t.persistence})}function Sl(t){return jl(t).then(function(t){return t.Sh})}function xl(t){return Al(t).then(function(t){return t.gl})}function kl(t){return Al(t).then(function(t){return t.fa})}function Dl(t){return Object(_r.b)(this,void 0,void 0,function(){var e,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:return[4,Al(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Hh.bind(null,e.fa),n.Jh=Jh.bind(null,e.fa),n)]}})})}function Cl(t,e,n){var r=this;void 0===n&&(n={});var i=new bu;return t.fs.ys(function(){return Object(_r.b)(r,void 0,void 0,function(){var r;return Object(_r.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Af({next:function(o){e.ys(function(){return Dh(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new qr(Mr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new qr(Mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Rh(ho(n.path),o,{includeMetadataChanges:!0,sl:!0});return kh(t,s)},[4,Dl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function Pl(t,e,n){var r=this;void 0===n&&(n={});var i=new bu;return t.fs.ys(function(){return Object(_r.b)(r,void 0,void 0,function(){var r;return Object(_r.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Af({next:function(n){e.ys(function(){return Dh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new qr(Mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Rh(n,o,{includeMetadataChanges:!0,sl:!0});return kh(t,s)},[4,Dl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var Ll=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Qc(this,"async_queue_retry"),this.vf=function(){var e=Xc();e&&jr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Xc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Xc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(_r.b)(this,void 0,void 0,function(){var t,e=this;return Object(_r.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!Eu(t=n.sent()))throw t;return jr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,Ar("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Su.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&xr()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(_r.b)(this,void 0,void 0,function(){var t;return Object(_r.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Rl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new Ll,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(_r.c)(e,t),e.prototype.b_=function(){return this.Lf||Ul(this),this.Lf.terminate()},e}(qf);function Vl(t){return t.Lf||Ul(t),t.Lf.df(),t.Lf}function Ul(t){var e=t.p_(),n=function(t,e,n){return new Kr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new _l(t.m_,t.Mf,n)}function Ml(t,e,n){var r=this,i=new bu;return t.fs.enqueue(function(){return Object(_r.b)(r,void 0,void 0,function(){var r;return Object(_r.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,El(t,n)];case 1:return o.sent(),[4,Tl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Mr.FAILED_PRECONDITION||t.code===Mr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function ql(t){if(t.R_||t.P_)throw new qr(Mr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Fl=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Oi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return di(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(vi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw xr()}},t.prototype.Wf=function(t,e){var n=this,r={};return ci(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Wf(di(t.latitude),di(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=gi(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(bi(t));default:return null}},t.prototype.Bf=function(t){var e=pi(t);return new ei(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=ii.ct(t);kr(gu(n));var r=new Jr(n.get(1),n.get(3)),i=new ui(n.X(5));return r.isEqual(e)||Ar("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),zl=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ff(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Gl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Bl("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Gl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(zl);function Bl(t,e){return"string"==typeof e?bl(t,e):e instanceof zr?e._.d_:e.d_}function Hl(t){if(lo(t)&&0===t.Nt.length)throw new qr(Mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kl=function(){};function Jl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Wl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(_r.c)(e,t),e.prototype.Yf=function(t){var e=el(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new qr(Mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ep(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(tp(r,t,h[c]));u={arrayValue:{values:a}}}else u=tp(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ep(s,o),u=fl(n,"where",s,"in"===o||"not-in"===o);var f=Ji.create(i,o,u);return function(t,e){if(e.xt()){var n=vo(t);if(null!==n&&!n.isEqual(e.field))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=po(t);null!==r&&np(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new qr(Mr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new zf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new ao(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Kl),Xl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(_r.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new io(e,n);return function(t,e){if(null===po(t)){var n=vo(t);null!==n&&np(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new zf(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new ao(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Kl),Yl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(_r.c)(e,t),e.prototype.Yf=function(t){return new zf(t.firestore,t.v_,mo(t.C_,this.nd,this.sd))},e}(Kl),Ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(_r.c)(e,t),e.prototype.Yf=function(t){var e=Zl(t,this.type,this.rd,this.od);return new zf(t.firestore,t.v_,function(t,e){return new ao(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Kl),$l=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(_r.c)(e,t),e.prototype.Yf=function(t){var e=Zl(t,this.type,this.rd,this.od);return new zf(t.firestore,t.v_,function(t,e){return new ao(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Kl);function Zl(t,e,n,r){if(n[0]instanceof zr&&(n[0]=n[0]._),n[0]instanceof zl)return function(t,e,n,r,i){if(!r)throw new qr(Mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=go(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(Si(e,r.key));else{var c=r.field(a.field);if(yi(c))throw new qr(Mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new no(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=el(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new qr(Mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!yo(t)&&-1!==c.indexOf("/"))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.ct(c));if(!ui.Et(h))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ui(h);u.push(Si(e,f))}else{var l=fl(n,r,c);u.push(l)}}return new no(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function tp(t,e,n){if(n instanceof zr&&(n=n._),"string"==typeof n){if(""===n)throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!yo(e)&&-1!==n.indexOf("/"))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ii.ct(n));if(!ui.Et(r))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Si(t,new ui(r))}if(n instanceof Ff)return Si(t,n.S_);throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lf(n)+".")}function ep(t,e){if(!Array.isArray(t)||0===t.length)throw new qr(Mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new qr(Mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function np(t,e,n){if(!n.isEqual(e))throw new qr(Mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function rp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function ip(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var op=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(_r.c)(e,t),e.prototype.Uf=function(t){return new Fr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Ff(this.firestore,null,e)},e}(Fl),sp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),up=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(_r.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new ap(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Bl("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(zl),ap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(up),cp=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new sp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new ap(n.zf,n.Hf,r.key,r,new sp(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new qr(Mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new ap(t.zf,t.Hf,e.doc.key,e.doc,new sp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new ap(t.zf,t.Hf,e.doc.key,e.doc,new sp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:hp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function hp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}function fp(t,e){return t instanceof up&&e instanceof up?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof cp&&e instanceof cp&&t.zf===e.zf&&Jf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var lp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(_r.c)(e,t),e.prototype.Uf=function(t){return new Fr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Ff(this.firestore,null,e)},e}(Fl);function pp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Rf(t,Ff);var o=Rf(t.firestore,Rl),s=el(o);return e instanceof zr&&(e=e._),vp(o,[("string"==typeof e||e instanceof Nf?hl(s,"updateDoc",t.S_,e,n,r):cl(s,"updateDoc",t.S_,e)).O_(t.S_,Bo.exists(!0))])}function dp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof zr&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||rp(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(rp(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Ff)c=Rf(t.firestore,Rl),h=ho(t.S_.path),a={next:function(e){i[u]&&i[u](yp(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Rf(t,zf);c=Rf(p.firestore,Rl),h=p.C_;var d=new lp(c);a={next:function(t){i[u]&&i[u](new cp(c,d,p,t))},error:i[u+1],complete:i[u+2]},Hl(t.C_)}return function(t,e,n,r){var i=this,o=new Af(r),s=new Rh(e,o,n);return t.fs.ys(function(){return Object(_r.b)(i,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return e=kh,[4,Dl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(_r.b)(i,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return e=Dh,[4,Dl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Vl(c),h,f,a)}function vp(t,e){return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var n;return Object(_r.d)(this,function(i){switch(i.label){case 0:return n=Wh,[4,kl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Vl(t),e)}function yp(t,e,n){var r=n.docs.get(e.S_),i=new lp(t);return new up(t,i,e.S_,r,new sp(n.hasPendingWrites,n.fromCache),e.v_)}var gp=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=el(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=bp(t,this.zf),i=ip(r.v_,e,n),o=nl(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,Bo.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=bp(t,this.zf);return e instanceof zr&&(e=e._),o="string"==typeof e||e instanceof Nf?hl(this.wd,"WriteBatch.update",s.S_,e,n,r):cl(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,Bo.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=bp(t,this.zf);return this.fd=this.fd.concat(new ss(e.S_,Bo.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new qr(Mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function bp(t,e){if(t instanceof zr&&(t=t._),t.firestore!==e)throw new qr(Mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var mp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(_r.c)(e,t),e.prototype.get=function(e){var n=this,r=bp(e,this.zf),i=new lp(this.zf);return t.prototype.get.call(this,e).then(function(t){return new up(n.zf,i,r.S_,t.Jf,new sp(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=el(t)}return t.prototype.get=function(t){var e=this,n=bp(t,this.zf),r=new op(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return xr();var i=t[0];if(i instanceof qi)return new zl(e.zf,r,n.S_,null,n.v_);if(i instanceof Mi)return new zl(e.zf,r,i.key,i,n.v_);throw xr()})},t.prototype.set=function(t,e,n){var r=bp(t,this.zf),i=ip(r.v_,e,n),o=nl(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=bp(t,this.zf);return e instanceof zr&&(e=e._),o="string"==typeof e||e instanceof Nf?hl(this.wd,"Transaction.update",s.S_,e,n,r):cl(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=bp(t,this.zf);return this.Td.delete(e.S_),this},t}()),wp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ql(t=Rf(t,Rl));var n=Vl(t),r=t.p_(),i=new jf;return Ml(n,i,new Ef(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ql(t=Rf(t,Rl));var e=Vl(t),n=t.p_(),r=new jf;return Ml(e,r,new Tf(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new qr(Mr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new bu;return t.Mf.Tf(function(){return Object(_r.b)(e,void 0,void 0,function(){var e;return Object(_r.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(_r.b)(this,void 0,void 0,function(){return Object(_r.d)(this,function(e){switch(e.label){case 0:return Iu.jn()?[4,Iu.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(nc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),Ip=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Jr||(i.md=e),i}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Rf(t,qf)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&Nr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(_r.b)(e,void 0,void 0,function(){var e,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:return[4,Nl(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=Dr(t);return e.Oh.delete(0),ih(e)}(n))]}})})})}(Vl(Rf(this._,Rl)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(_r.b)(e,void 0,void 0,function(){var e,n;return Object(_r.d)(this,function(r){switch(r.label){case 0:return[4,Nl(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object(_r.b)(this,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return(e=Dr(t)).Oh.add(0),[4,oh(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Vl(Rf(this._,Rl)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Df("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new bu;return t.fs.ys(function(){return Object(_r.b)(e,void 0,void 0,function(){var e;return Object(_r.d)(this,function(r){switch(r.label){case 0:return e=tf,[4,kl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Vl(Rf(this._,Rl)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Af(e);return t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Dr(t).Wh.add(e),e.next()},[4,Dl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var e;return Object(_r.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Dr(t).Wh.delete(e)},[4,Dl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Vl(t=Rf(t,Rl)),rp(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new qr(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Pp(this,Bf(this._,t))}catch(t){throw jp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Tp(this,Hf(this._,t))}catch(t){throw jp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new kp(this,function(t,e){if(t=Rf(t,qf),xf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new qr(Mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new zf(t,null,function(t){return new ao(ii.at(),t)}(e))}(this._,t))}catch(t){throw jp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var n;return Object(_r.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Al(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new Ol(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Vl(t),function(n){return e(new mp(t,n))})}(this._,function(n){return t(new _p(e,n))})},e.prototype.batch=function(){var t=this;return Vl(this._),new Ep(new gp(this._,function(e){return vp(t._,e)}))},e.prototype.loadBundle=function(t){throw new qr(Mr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new qr(Mr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(zr),Op=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(_r.c)(e,t),e.prototype.Uf=function(t){return new Hr(new Fr(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return Tp.Ad(e,this.firestore,null)},e}(Fl),_p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new Op(e),r}return Object(_r.c)(e,t),e.prototype.get=function(t){var e=this,n=Lp(t);return this._.get(n).then(function(t){return new Sp(e.zf,new up(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=Lp(t);return n?(kf("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Lp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(_r.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Lp(t);return this._.delete(e),this},e}(zr),Ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.set=function(t,e,n){var r=Lp(t);return n?(kf("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Lp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(_r.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Lp(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(zr),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Op(e),r}return Object(_r.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new qr(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Ff(n._,r,new ui(t)))},e.Ad=function(t,n,r){return new e(n,new Ff(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Pp(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Pp(this.firestore,Bf(this._,t))}catch(t){throw jp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof Ff&&Kf(this._,t)},e.prototype.set=function(t,e){e=kf("DocumentReference.set",e);try{return function(t,e,n){t=Rf(t,Ff);var r=Rf(t.firestore,Rl),i=ip(t.v_,e,n);return vp(r,[nl(el(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,Bo.jt())])}(this._,t,e)}catch(t){throw jp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?pp(this._,t):pp.apply(void 0,Object(_r.g)([this._,t,e],n))}catch(t){throw jp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return vp(Rf((t=this._).firestore,Rl),[new ss(t.S_,Bo.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ap(e),i=Np(e,function(e){return new Sp(t.firestore,new up(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return dp(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Rl),n=Vl(e),r=new lp(e);return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var n;return Object(_r.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i;return Object(_r.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Dr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Mi?n.resolve(i):i instanceof qi?n.resolve(null):n.reject(new qr(Mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=xu(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Sl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new up(e,r,t.S_,n,new sp(n instanceof Mi&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Rl);return Cl(Vl(e),t.S_,{source:"server"}).then(function(n){return yp(e,t,n)})}(this._):function(t){t=Rf(t,Ff);var e=Rf(t.firestore,Rl);return Cl(Vl(e),t.S_).then(function(n){return yp(e,t,n)})}(this._)).then(function(t){return new Sp(e.firestore,new up(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(zr);function jp(t,e,n){return t.message=t.message.replace(e,n),t}function Ap(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!rp(r))return r}return{}}function Np(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=rp(t[0])?t[0]:rp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Sp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Tp(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return fp(this._,t._)},e}(zr),xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(Sp),kp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Op(e),r}return Object(_r.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Jl(this._,function(t,e,n){var r=e,i=Bl("where",t);return new Wl(i,r,n)}(t,n,r)))}catch(t){throw jp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Jl(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Bl("orderBy",t);return new Xl(r,n)}(t,n)))}catch(t){throw jp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Jl(this._,function(t){return Vf("limit",t),new Yl("limit",t,"F")}(t)))}catch(t){throw jp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Jl(this._,function(t){return Vf("limitToLast",t),new Yl("limitToLast",t,"L")}(t)))}catch(t){throw jp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Jl(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ql("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw jp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Jl(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ql("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw jp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Jl(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $l("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw jp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Jl(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $l("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw jp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Jf(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Rf(t,zf);var e=Rf(t.firestore,Rl),n=Vl(e),r=new lp(e);return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(_r.b)(n,void 0,void 0,function(){var n;return Object(_r.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(_r.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(_r.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,gc(t,e,!0)];case 1:return u=a.sent(),r=new Fh(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=xu(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,Sl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new cp(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Rf(t,zf);var e=Rf(t.firestore,Rl),n=Vl(e),r=new lp(e);return Pl(n,t.C_,{source:"server"}).then(function(n){return new cp(e,r,t,n)})}(this._):function(t){t=Rf(t,zf);var e=Rf(t.firestore,Rl),n=Vl(e),r=new lp(e);return Hl(t.C_),Pl(n,t.C_).then(function(n){return new cp(e,r,t,n)})}(this._)).then(function(t){return new Cp(e.firestore,new cp(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ap(e),i=Np(e,function(e){return new Cp(t.firestore,new cp(t.firestore._,t.Hf,t._,e.ud))});return dp(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(zr),Dp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new xp(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(zr),Cp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new kp(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new xp(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Dp(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new xp(n.zf,r))})},e.prototype.isEqual=function(t){return fp(this._,t._)},e}(zr),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(_r.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new Tp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Tp(this.firestore,void 0===t?Hf(this._):Hf(this._,t))}catch(t){throw jp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Rf(t.firestore,Rl),r=Hf(t),i=ip(t.v_,e);return vp(n,[nl(el(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,Bo.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new Tp(e.firestore,t)})},e.prototype.isEqual=function(t){return Kf(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(kp);function Lp(t){return t instanceof zr&&(t=t._),Rf(t,Ff)}var Rp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Nf.bind.apply(Nf,Object(_r.g)([void 0],e))))||this}return Object(_r.c)(e,t),e.documentId=function(){return new e(si.lt().ot())},e.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof Nf&&this._.d_.isEqual(t.d_)},e}(zr),Vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(_r.c)(e,t),e.serverTimestamp=function(){var t=new ol("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new rl("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sl("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ul("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new al("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(zr);!function(){function t(){this.Pd={},this.yd=new bu,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var Up,Mp=n("/6Yf"),qp={Firestore:Ip,GeoPoint:Wf,Timestamp:ei,Blob:Hr,Transaction:_p,WriteBatch:Ep,DocumentReference:Tp,DocumentSnapshot:Sp,Query:kp,QueryDocumentSnapshot:xp,QuerySnapshot:Cp,CollectionReference:Pp,FieldPath:Rp,FieldValue:Vp,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Mp.a("firestore",function(t){return function(t,e){return new Ip(t,new Rl(t,e),new wp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},qp)))})(Up=b.a),Up.registerVersion("@firebase/firestore","2.1.2");var Fp=n("XNiG"),zp=n("VRyK"),Gp=n("eIep"),Bp=n("UXun"),Hp=n("SxV6");function Kp(t,e){return e?Object(Gp.a)(()=>t,e):Object(Gp.a)(()=>t)}var Jp=n("tf+s");const Wp=new r.InjectionToken("angularfire2.auth.use-emulator"),Xp=new r.InjectionToken("angularfire2.auth.settings"),Yp=new r.InjectionToken("angularfire2.auth.tenant-id"),Qp=new r.InjectionToken("angularfire2.auth.langugage-code"),$p=new r.InjectionToken("angularfire2.auth.use-device-language"),Zp=new r.InjectionToken("angularfire.auth.persistence");let td=(()=>{class t{constructor(t,e,r,i,a,c,f,l,g,b){const m=new v.d(i),w=Object(v.h)(m),I=new Fp.a,O=Object(u.a)(void 0).pipe(Object(d.b)(m.outsideAngular),Object(Gp.a)(()=>i.runOutsideAngular(()=>n.e(8).then(n.bind(null,"6nsN")))),Object(h.a)(()=>Object(v.g)(t,i,e)),Object(h.a)(t=>i.runOutsideAngular(()=>{const e=a,n=c;return Object(v.f)(t.name+".auth","AngularFireAuth",t,()=>{const r=i.runOutsideAngular(()=>t.auth());return e&&r.useEmulator("http://"+e.join(":")),f&&(r.tenantId=f),r.languageCode=l,g&&r.useDeviceLanguage(),n&&(r.settings=n),b&&r.setPersistence(b),r},[e,f,l,g,n,b])})),Object(Bp.a)({bufferSize:1,refCount:!1}));if(Object(y.B)(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(u.a)(null);else{O.pipe(Object(Hp.a)()).subscribe();const t=O.pipe(Object(Gp.a)(t=>t.getRedirectResult().then(t=>t,()=>null)),w,Object(Bp.a)({bufferSize:1,refCount:!1})),e=t=>new o.a(e=>({unsubscribe:i.runOutsideAngular(()=>t(e))})),n=O.pipe(Object(Gp.a)(t=>e(t.onAuthStateChanged.bind(t)))),r=O.pipe(Object(Gp.a)(t=>e(t.onIdTokenChanged.bind(t))));this.authState=t.pipe(Kp(n),Object(Jp.a)(m.outsideAngular),Object(d.b)(m.insideAngular)),this.user=t.pipe(Kp(r),Object(Jp.a)(m.outsideAngular),Object(d.b)(m.insideAngular)),this.idToken=this.user.pipe(Object(Gp.a)(t=>t?Object(s.a)(t.getIdToken()):Object(u.a)(null))),this.idTokenResult=this.user.pipe(Object(Gp.a)(t=>t?Object(s.a)(t.getIdTokenResult()):Object(u.a)(null))),this.credential=Object(zp.a)(t,I,this.authState.pipe(Object(p.a)(t=>!t))).pipe(Object(h.a)(t=>(null==t?void 0:t.user)?t:null),Object(Jp.a)(m.outsideAngular),Object(d.b)(m.insideAngular))}return Object(v.i)(this,O,i,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>I.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(r["\u0275\u0275inject"](v.c),r["\u0275\u0275inject"](v.b,8),r["\u0275\u0275inject"](r.PLATFORM_ID),r["\u0275\u0275inject"](r.NgZone),r["\u0275\u0275inject"](Wp,8),r["\u0275\u0275inject"](Xp,8),r["\u0275\u0275inject"](Yp,8),r["\u0275\u0275inject"](Qp,8),r["\u0275\u0275inject"]($p,8),r["\u0275\u0275inject"](Zp,8))},t.\u0275prov=Object(r["\u0275\u0275defineInjectable"])({factory:function(){return new t(Object(r["\u0275\u0275inject"])(v.c),Object(r["\u0275\u0275inject"])(v.b,8),Object(r["\u0275\u0275inject"])(r.PLATFORM_ID),Object(r["\u0275\u0275inject"])(r.NgZone),Object(r["\u0275\u0275inject"])(Wp,8),Object(r["\u0275\u0275inject"])(Xp,8),Object(r["\u0275\u0275inject"])(Yp,8),Object(r["\u0275\u0275inject"])(Qp,8),Object(r["\u0275\u0275inject"])($p,8),Object(r["\u0275\u0275inject"])(Zp,8))},token:t,providedIn:"any"}),t})();function ed(t,e){return function(t,e=i.b){return new o.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function nd(t,e){return ed(t,e).pipe(Object(h.a)(t=>({payload:t,type:"query"})))}function rd(t,e){return nd(t,e).pipe(Object(a.a)(void 0),Object(c.a)(),Object(h.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function id(t,e,n){return rd(t,n).pipe(Object(f.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return od(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return od(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return od(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(l.a)(),Object(h.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function od(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function sd(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}Object(v.e)(td,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);class ud{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=rd(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(h.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(a.a)(void 0),Object(c.a)(),Object(p.a)(([t,e])=>e.length>0||!t),Object(h.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(f.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=sd(t);return id(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return nd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(h.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(s.a)(this.query.get(t)).pipe(Object(d.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new ad(this.ref.doc(t),this.afs)}}class ad{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=dd(n,e);return new ud(r,i,this.afs)}snapshotChanges(){return ed(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(a.a)(void 0),Object(c.a)(),Object(h.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(h.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(s.a)(this.ref.get(t)).pipe(Object(d.b)(this.afs.schedulers.insideAngular))}}class cd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?rd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(h.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(p.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):rd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(f.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=sd(t);return id(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return nd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(h.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(s.a)(this.query.get(t)).pipe(Object(d.b)(this.afs.schedulers.insideAngular))}}const hd=new r.InjectionToken("angularfire2.enableFirestorePersistence"),fd=new r.InjectionToken("angularfire2.firestore.persistenceSettings"),ld=new r.InjectionToken("angularfire2.firestore.settings"),pd=new r.InjectionToken("angularfire2.firestore.use-emulator");function dd(t,e=(t=>t)){return{query:e(t),ref:t}}let vd=(()=>{class t{constructor(t,e,n,r,i,o,a,c,h){this.schedulers=new v.d(o),this.keepUnstableUntilFirst=Object(v.h)(this.schedulers);const f=Object(v.g)(t,o,e);!g.a.auth&&h&&Object(v.j)();const l=c;[this.firestore,this.persistenceEnabled$]=Object(v.f)(f.name+".firestore","AngularFirestore",f,()=>{const t=o.runOutsideAngular(()=>f.firestore());if(r&&t.settings(r),l&&t.useEmulator(...l),n&&!Object(y.B)(i)){const e=()=>{try{return Object(s.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(Up){return"undefined"!=typeof console&&console.warn(Up),Object(u.a)(!1)}};return[t,o.runOutsideAngular(e)]}return[t,Object(u.a)(!1)]},[r,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=dd(n,e),o=this.schedulers.ngZone.run(()=>r);return new ud(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new cd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new ad(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(r["\u0275\u0275inject"](v.c),r["\u0275\u0275inject"](v.b,8),r["\u0275\u0275inject"](hd,8),r["\u0275\u0275inject"](ld,8),r["\u0275\u0275inject"](r.PLATFORM_ID),r["\u0275\u0275inject"](r.NgZone),r["\u0275\u0275inject"](fd,8),r["\u0275\u0275inject"](pd,8),r["\u0275\u0275inject"](Wp,8))},t.\u0275prov=Object(r["\u0275\u0275defineInjectable"])({factory:function(){return new t(Object(r["\u0275\u0275inject"])(v.c),Object(r["\u0275\u0275inject"])(v.b,8),Object(r["\u0275\u0275inject"])(hd,8),Object(r["\u0275\u0275inject"])(ld,8),Object(r["\u0275\u0275inject"])(r.PLATFORM_ID),Object(r["\u0275\u0275inject"])(r.NgZone),Object(r["\u0275\u0275inject"])(fd,8),Object(r["\u0275\u0275inject"])(pd,8),Object(r["\u0275\u0275inject"])(Wp,8))},token:t,providedIn:"any"}),t})()},"w+5F":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("fXoL"),i=n("aceb");let o=(()=>{class t{constructor(t){this.menuService=t}goToHome(){this.menuService.navigateHome()}}return t.\u0275fac=function(e){return new(e||t)(r["\u0275\u0275directiveInject"](i.L))},t.\u0275cmp=r["\u0275\u0275defineComponent"]({type:t,selectors:[["ngx-not-found"]],decls:11,vars:0,consts:[[1,"row"],[1,"col-md-12"],[1,"flex-centered","col-xl-4","col-lg-6","col-md-8","col-sm-12"],[1,"title"],[1,"sub-title"],["nbButton","","fullWidth","","type","button",1,"home-button",3,"click"]],template:function(t,e){1&t&&(r["\u0275\u0275elementStart"](0,"div",0),r["\u0275\u0275elementStart"](1,"div",1),r["\u0275\u0275elementStart"](2,"nb-card"),r["\u0275\u0275elementStart"](3,"nb-card-body"),r["\u0275\u0275elementStart"](4,"div",2),r["\u0275\u0275elementStart"](5,"h2",3),r["\u0275\u0275text"](6,"404 Page Not Found"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](7,"small",4),r["\u0275\u0275text"](8,"The page you were looking for doesn't exist"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](9,"button",5),r["\u0275\u0275listener"]("click",function(){return e.goToHome()}),r["\u0275\u0275text"](10," Take me home "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]())},directives:[i.m,i.l,i.j],styles:[".flex-centered[_ngcontent-%COMP%]{margin:auto}nb-card-body[_ngcontent-%COMP%]{display:flex}.sub-title[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{text-align:center}.sub-title[_ngcontent-%COMP%]{display:block;margin-bottom:3rem}.home-button[_ngcontent-%COMP%]{margin-bottom:2rem}"]}),t})()}}]);